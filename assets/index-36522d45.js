var Pt=Object.defineProperty;var Ut=(t,e,n)=>e in t?Pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ee=(t,e,n)=>(Ut(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();function I(){}function Nt(t,e){for(const n in e)t[n]=e[n];return t}function ht(t){return t()}function Ie(){return Object.create(null)}function re(t){t.forEach(ht)}function ee(t){return typeof t=="function"}function W(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Mt(t){return Object.keys(t).length===0}function mt(t,...e){if(t==null){for(const r of e)r(void 0);return I}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function zt(t){let e;return mt(t,n=>e=n)(),e}function ne(t,e,n){t.$$.on_destroy.push(mt(e,n))}function Kt(t,e,n,r){if(t){const l=pt(t,e,n,r);return t[0](l)}}function pt(t,e,n,r){return t[1]&&r?Nt(n.ctx.slice(),t[1](r(e))):n.ctx}function qt(t,e,n,r){if(t[2]&&r){const l=t[2](r(n));if(e.dirty===void 0)return l;if(typeof l=="object"){const i=[],s=Math.max(e.dirty.length,l.length);for(let o=0;o<s;o+=1)i[o]=e.dirty[o]|l[o];return i}return e.dirty|l}return e.dirty}function jt(t,e,n,r,l,i){if(l){const s=pt(e,n,r,i);t.p(s,l)}}function Vt(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function He(t){return t??""}function O(t,e){t.appendChild(e)}function q(t,e,n){t.insertBefore(e,n||null)}function N(t){t.parentNode&&t.parentNode.removeChild(t)}function ge(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function F(t){return document.createElement(t)}function ke(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function $(t){return document.createTextNode(t)}function V(){return $(" ")}function H(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function S(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Rt(t){return Array.from(t.childNodes)}function De(t,e){e=""+e,t.data!==e&&(t.data=e)}function Je(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}let Se;function It(){if(Se===void 0){Se=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Se=!0}}return Se}function Ht(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const r=F("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const l=It();let i;return l?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=H(window,"message",s=>{s.source===r.contentWindow&&e()})):(r.src="about:blank",r.onload=()=>{i=H(r.contentWindow,"resize",e),e()}),O(t,r),()=>{(l||i&&r.contentWindow)&&i(),N(r)}}function L(t,e,n){t.classList.toggle(e,!!n)}function Jt(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}function We(t,e){return new t(e)}let _e;function pe(t){_e=t}function be(){if(!_e)throw new Error("Function called outside component initialization");return _e}function Wt(t){be().$$.on_mount.push(t)}function Bt(t){be().$$.on_destroy.push(t)}function Gt(){const t=be();return(e,n,{cancelable:r=!1}={})=>{const l=t.$$.callbacks[e];if(l){const i=Jt(e,n,{cancelable:r});return l.slice().forEach(s=>{s.call(t,i)}),!i.defaultPrevented}return!0}}function Qt(t,e){return be().$$.context.set(t,e),e}function _t(t){return be().$$.context.get(t)}function Be(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const ce=[],Ge=[];let de=[];const Qe=[],Xt=Promise.resolve();let Le=!1;function Yt(){Le||(Le=!0,Xt.then(vt))}function ve(t){de.push(t)}const Fe=new Set;let ae=0;function vt(){if(ae!==0)return;const t=_e;do{try{for(;ae<ce.length;){const e=ce[ae];ae++,pe(e),Zt(e.$$)}}catch(e){throw ce.length=0,ae=0,e}for(pe(null),ce.length=0,ae=0;Ge.length;)Ge.pop()();for(let e=0;e<de.length;e+=1){const n=de[e];Fe.has(n)||(Fe.add(n),n())}de.length=0}while(ce.length);for(;Qe.length;)Qe.pop()();Le=!1,Fe.clear(),pe(t)}function Zt(t){if(t.fragment!==null){t.update(),re(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ve)}}function $t(t){const e=[],n=[];de.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),de=e}const we=new Set;let se;function Y(){se={r:0,c:[],p:se}}function Z(){se.r||re(se.c),se=se.p}function C(t,e){t&&t.i&&(we.delete(t),t.i(e))}function A(t,e,n,r){if(t&&t.o){if(we.has(t))return;we.add(t),se.c.push(()=>{we.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function X(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function K(t){t&&t.c()}function M(t,e,n){const{fragment:r,after_update:l}=t.$$;r&&r.m(e,n),ve(()=>{const i=t.$$.on_mount.map(ht).filter(ee);t.$$.on_destroy?t.$$.on_destroy.push(...i):re(i),t.$$.on_mount=[]}),l.forEach(ve)}function z(t,e){const n=t.$$;n.fragment!==null&&($t(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function xt(t,e){t.$$.dirty[0]===-1&&(ce.push(t),Yt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(t,e,n,r,l,i,s,o=[-1]){const f=_e;pe(t);const u=t.$$={fragment:null,ctx:[],props:i,update:I,not_equal:l,bound:Ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Ie(),dirty:o,skip_bound:!1,root:e.target||f.$$.root};s&&s(u.root);let g=!1;if(u.ctx=n?n(t,e.props||{},(d,a,...m)=>{const h=m.length?m[0]:a;return u.ctx&&l(u.ctx[d],u.ctx[d]=h)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](h),g&&xt(t,d)),a}):[],u.update(),g=!0,re(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const d=Rt(e.target);u.fragment&&u.fragment.l(d),d.forEach(N)}else u.fragment&&u.fragment.c();e.intro&&C(t.$$.fragment),M(t,e.target,e.anchor),vt()}pe(f)}class G{constructor(){Ee(this,"$$");Ee(this,"$$set")}$destroy(){z(this,1),this.$destroy=I}$on(e,n){if(!ee(n))return I;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const l=r.indexOf(n);l!==-1&&r.splice(l,1)}}$set(e){this.$$set&&!Mt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const en="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(en);const fe=[];function Ue(t,e=I){let n;const r=new Set;function l(o){if(W(t,o)&&(t=o,n)){const f=!fe.length;for(const u of r)u[1](),fe.push(u,t);if(f){for(let u=0;u<fe.length;u+=2)fe[u][0](fe[u+1]);fe.length=0}}}function i(o){l(o(t))}function s(o,f=I){const u=[o,f];return r.add(u),r.size===1&&(n=e(l,i)||I),o(t),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:l,update:i,subscribe:s}}const bt="settings",tn={game:"pileon",colors:"default",size:"default"},nn=JSON.parse(localStorage.getItem(bt)),he=Ue(nn??tn);he.subscribe(t=>localStorage.setItem(bt,JSON.stringify(t)));const rn={},Ce=Ue(rn),ln=4.5,sn=5,un=3,Xe=7,on=5,yt=t=>{switch(t){case"bridge":return{height:Xe,width:ln};case"poker":return{height:Xe,width:sn};case"small":return{height:on,width:un}}},Ne="card-appearance",an={size:"bridge",fourColor:!1},fn=({size:t,colors:e})=>({size:t==="default"?"poker":t,fourColor:e==="four-color"}),St=t=>{const e=Ue(an,n=>(he.subscribe(r=>n(t(r))),()=>{}));return Qt(Ne,e),e},Me=()=>_t(Ne),cn=t=>{const e=_t(Ne);if(e){const n=zt(he);e.set(t(n))}},Pe=(t,e,n={})=>r=>{(Array.isArray(t)?t:[t]).includes(r.code)&&e!==void 0&&(n.preventDefault&&r.preventDefault(),e())};var te={},ye={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CardStringType=t.CardSuits=void 0;function e(u,g){if(!(u instanceof g))throw new TypeError("Cannot call a class as a function")}function n(u,g){for(var d=0;d<g.length;d++){var a=g[d];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(u,a.key,a)}}function r(u,g,d){return g&&n(u.prototype,g),d&&n(u,d),u}function l(u,g,d){return g in u?Object.defineProperty(u,g,{value:d,enumerable:!0,configurable:!0,writable:!0}):u[g]=d,u}var i;t.CardSuits=i,function(u){u[u.Hearts=0]="Hearts",u[u.Spades=1]="Spades",u[u.Diamonds=2]="Diamonds",u[u.Clubs=3]="Clubs"}(i||(t.CardSuits=i={}));var s;t.CardStringType=s,function(u){u.Short="SHORT",u.Long="LONG",u.ShortEmoji="SHORT_EMOJI",u.ShortSuit="SHORT_SUIT",u.LongSuit="LONG_SUIT",u.EmojiSuit="EMOJI_SUIT",u.ShortValue="SHORT_VALUE",u.LongValue="LONG_VALUE"}(s||(t.CardStringType=s={}));var o=function(){function u(g){e(this,u),l(this,"num",void 0),this.num=g}return r(u,[{key:"toString",value:function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u.StringType.Long;switch(d){case u.StringType.Short:return this.toString(u.StringType.ShortValue)+this.toString(u.StringType.ShortSuit);case u.StringType.ShortEmoji:return this.toString(u.StringType.ShortValue)+this.toString(u.StringType.EmojiSuit);case u.StringType.Long:return this.toString(u.StringType.LongValue)+" of "+this.toString(u.StringType.LongSuit);case u.StringType.ShortSuit:return u.shortSuits[this.suit];case u.StringType.LongSuit:return u.longSuits[this.suit];case u.StringType.EmojiSuit:return u.emojiSuits[this.suit];case u.StringType.ShortValue:return u.shortValues[this.value===13?0:this.value];case u.StringType.LongValue:return u.longValues[this.value===13?0:this.value]}throw new Error("Unsupported output type")}},{key:"suit",get:function(){return u.getSuit(this.num)}},{key:"value",get:function(){return u.getValue(this.num)}}],[{key:"fromJSON",value:function(d){var a=d.num;return new u(a)}},{key:"getSuit",value:function(d){return Math.floor(d/13)%4}},{key:"getValue",value:function(d){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return d%13||a?d%13:13}},{key:"compare",value:function(d,a){return a.value-d.value}}]),u}();l(o,"Suits",i),l(o,"StringType",s),l(o,"emojiSuits",["♥","♠","♦","♣"]),l(o,"shortSuits",["h","s","d","c"]),l(o,"longSuits",["hearts","spades","diamonds","clubs"]),l(o,"shortValues",["A","2","3","4","5","6","7","8","9","T","J","Q","K"]),l(o,"longValues",["ace","two","three","four","five","six","seven","eight","nine","ten","jack","queen","king"]);var f=o;t.default=f})(ye);var wt={},J={};Object.defineProperty(J,"__esModule",{value:!0});J.uniqueFilter=J.shuffle=J.last=J.isSorted=J.getCombinations=J.arraySubtraction=void 0;var dn=function(e,n){return e.filter(function(r){return!n.includes(r)})};J.arraySubtraction=dn;var gn=function t(e,n,r,l,i){if(l.length>=n)i.push(l);else for(var s=r;s<e.length;s++)t(e,n,s+1,l.concat(e[s]),i)},hn=function(e,n){var r=[];return gn(e,n,0,[],r),r};J.getCombinations=hn;var mn=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=r?-1:1;try{return e.reduce(function(i,s){if(l*n(i,s)<=0)return s;throw new Error}),!0}catch{return!1}};J.isSorted=mn;var pn=function(e){return e[e.length-1]};J.last=pn;var _n=function(e){for(var n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),l=[e[r],e[n]];e[n]=l[0],e[r]=l[1]}return e};J.shuffle=_n;var vn=function(e,n,r){return r.indexOf(e)===n};J.uniqueFilter=vn;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=r(ye),n=J;function r(h){return h&&h.__esModule?h:{default:h}}function l(h){return o(h)||s(h)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(h){if(Symbol.iterator in Object(h)||Object.prototype.toString.call(h)==="[object Arguments]")return Array.from(h)}function o(h){if(Array.isArray(h)){for(var v=0,T=new Array(h.length);v<h.length;v++)T[v]=h[v];return T}}function f(h,v){if(!(h instanceof v))throw new TypeError("Cannot call a class as a function")}function u(h,v){for(var T=0;T<v.length;T++){var c=v[T];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(h,c.key,c)}}function g(h,v,T){return v&&u(h.prototype,v),T&&u(h,T),h}function d(h,v,T){return v in h?Object.defineProperty(h,v,{value:T,enumerable:!0,configurable:!0,writable:!0}):h[v]=T,h}var a=function(){function h(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;f(this,h),d(this,"cards",void 0),this.cards=l(Array(52*T).keys()).map(function(c){return new e.default(c)}),v&&this.shuffle()}return g(h,[{key:"shuffle",value:function(){(0,n.shuffle)(this.cards)}},{key:"isShuffled",value:function(){return!(0,n.isSorted)(this.cards,function(T,c){return T.num-c.num})}},{key:"pop",value:function(){return this.cards.pop()}},{key:"popN",value:function(T){for(var c=[],k,p=0;p<T&&(k=this.pop());p++)c.push(k);return c}},{key:"cardsRemaining",get:function(){return this.cards.length}}],[{key:"fromJSON",value:function(T){var c=T.cards,k=new h(!1,0);return k.cards=c.map(function(p){return e.default.fromJSON(p)}),k}}]),h}(),m=a;t.default=m})(wt);var kt={},Ae={};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.uuid4=void 0;var bn=function(e){var n;do n=Math.random().toString(16).slice(2,e+2);while(n.length<e&&e<=12);return n},yn=function(){var e=[8,4,4,4,12],n=e.map(bn).join("-").split("");return n[14]="4",n[19]=(Math.floor(Math.random()*64)%4+8).toString(16),n.join("")};Ae.uuid4=yn;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HandRank=void 0;var e=l(ye),n=Ae,r=J;function l(c){return c&&c.__esModule?c:{default:c}}function i(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(p){return typeof p}:i=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},i(c)}function s(c){return u(c)||f(c)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(c){if(Symbol.iterator in Object(c)||Object.prototype.toString.call(c)==="[object Arguments]")return Array.from(c)}function u(c){if(Array.isArray(c)){for(var k=0,p=new Array(c.length);k<c.length;k++)p[k]=c[k];return p}}function g(c,k){if(!(c instanceof k))throw new TypeError("Cannot call a class as a function")}function d(c,k){for(var p=0;p<k.length;p++){var y=k[p];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(c,y.key,y)}}function a(c,k,p){return k&&d(c.prototype,k),p&&d(c,p),c}function m(c,k,p){return k in c?Object.defineProperty(c,k,{value:p,enumerable:!0,configurable:!0,writable:!0}):c[k]=p,c}var h;t.HandRank=h,function(c){c[c.High=0]="High",c[c.Pair=5]="Pair",c[c.TwoPairs=10]="TwoPairs",c[c.ThreeOfAKind=15]="ThreeOfAKind",c[c.Straight=20]="Straight",c[c.Flush=25]="Flush",c[c.FullHouse=30]="FullHouse",c[c.FourOfAKind=35]="FourOfAKind",c[c.StraightFlush=40]="StraightFlush",c[c.FiveOfAKind=45]="FiveOfAKind"}(h||(t.HandRank=h={}));var v=function(){function c(k,p,y){g(this,c),m(this,"uuid",void 0),m(this,"rank",void 0),m(this,"cards",void 0),this.rank=k,this.cards=p,this.uuid=y||(0,n.uuid4)()}return a(c,[{key:"getCardsString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.default.StringType.Short;return this.cards.map(function(y){return y.toString(p)}).join(", ")}},{key:"toString",value:function(){var p=this,y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.default.StringType.Short,w=e.default.StringType.LongValue,_=function(E){return p.cards[E].toString(w)},b=this.getCardsString(y);switch(this.rank){case c.Rank.FiveOfAKind:return"Five of a kind, ".concat(_(0),"s (").concat(b,")");case c.Rank.StraightFlush:return"Straigth flush, ".concat(_(0)," high (").concat(b,")");case c.Rank.FourOfAKind:return"Four of a kind, ".concat(_(0),"s (").concat(b,")");case c.Rank.FullHouse:return"Full house, ".concat(_(0),"s over ").concat(_(3),"s (").concat(b,")");case c.Rank.Flush:return"Flush, ".concat(_(0)," high (").concat(b,")");case c.Rank.Straight:return"Straigth, ".concat(_(0)," high (").concat(b,")");case c.Rank.ThreeOfAKind:return"Three of a kind, ".concat(_(0),"s (").concat(b,")");case c.Rank.TwoPairs:return"Two pairs, ".concat(_(0),"s and ").concat(_(2),"s (").concat(b,")");case c.Rank.Pair:return"Pair, ".concat(_(0),"s (").concat(b,")");case c.Rank.High:return"".concat(_(0).replace(/^\w/,function(D){return D.toUpperCase()})," high (").concat(b,")")}throw new Error("Unsupported rank value")}}],[{key:"fromJSON",value:function(p){var y=p.rank,w=p.cards,_=p.uuid;return new c(y,w.map(e.default.fromJSON),_)}},{key:"solve",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,w,_;return(w=c.isNumOfAKind(5,p))?_=c.Rank.FiveOfAKind:(w=c.isStraightFlush(p,y))?_=c.Rank.StraightFlush:(w=c.isNumOfAKind(4,p))?_=c.Rank.FourOfAKind:(w=c.isFullHouse(p))?_=c.Rank.FullHouse:(w=c.isFlush(p,y))?_=c.Rank.Flush:(w=c.isStraight(p,y))?_=c.Rank.Straight:(w=c.isNumOfAKind(3,p))?_=c.Rank.ThreeOfAKind:(w=c.isTwoPairs(p))?_=c.Rank.TwoPairs:(w=c.isNumOfAKind(2,p))?_=c.Rank.Pair:(w=[],_=c.Rank.High),w=c.fillWithKickers(w,p),new c(_,w)}},{key:"solveHoldEm",value:function(p,y){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(w===0)return c.solve([].concat(s(p),s(y)));for(var _=(0,r.getCombinations)(p,p.length-w),b=(0,r.getCombinations)(y,Math.min(y.length,w)),D=[],E=0;E<_.length;E++)for(var U=0;U<b.length;U++)D.push(c.solve([].concat(s(_[E]),s(b[U]))));return c.max.apply(c,D)}},{key:"compare",value:function(p,y){var w;if(p.cards.length!==y.cards.length)throw new Error("Comparing hands with different number of cards");if((w=y.rank-p.rank)!==0)return w;for(var _=0;_<p.cards.length;_++)if((w=e.default.compare(p.cards[_],y.cards[_]))!==0)return w;return 0}},{key:"winners",value:function(){for(var p=arguments.length,y=new Array(p),w=0;w<p;w++)y[w]=arguments[w];var _=c.max.apply(c,y);return y.filter(function(b){return!c.compare(b,_)})}},{key:"max",value:function(){for(var p=function(D,E){return c.compare(D,E)<0?D:E},y=arguments.length,w=new Array(y),_=0;_<y;_++)w[_]=arguments[_];return w.reduce(function(b,D){return p(b,D)})}},{key:"fillWithKickers",value:function(p,y){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;return y=(0,r.arraySubtraction)(y,p).sort(e.default.compare),[].concat(s(p),s(y)).slice(0,w)}},{key:"getUniqueValues",value:function(p){return p.map(function(y){return y.value}).filter(r.uniqueFilter).sort(function(y,w){return w-y})}},{key:"isNumOfAKind",value:function(p,y){for(var w=c.getUniqueValues(y),_,b=function(j){if(_=y.filter(function(Q){return Q.value==w[j]}),_.length>=p)return{v:_}},D=0;D<w.length;D++){var E=b(D);if(i(E)==="object")return E.v}return!1}},{key:"isNumOfAKindCombination",value:function(p,y){for(var w=[],_=0;_<p.length;_++){var b=c.isNumOfAKind(p[_],(0,r.arraySubtraction)(y,w));if(b===!1)return!1;b=b,w.push.apply(w,s(b))}return w}},{key:"isStraightFlush",value:function(p){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,w=[],_=function(U){if(w=p.filter(function(Q){return Q.suit===U}),w.length<y)return"continue";var j=c.isStraight(w,y);if(j)return{v:j}},b=0;b<4;b++){var D=_(b);switch(D){case"continue":continue;default:if(i(D)==="object")return D.v}}return!1}},{key:"isFullHouse",value:function(p){return c.isNumOfAKindCombination([3,2],p)}},{key:"isFlush",value:function(p){for(var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,w=function(E){var U=p.filter(function(j){return j.suit==E});if(U.length>=y)return{v:U.sort(e.default.compare).slice(0,y)}},_=0;_<4;_++){var b=w(_);if(i(b)==="object")return b.v}return!1}},{key:"isStraight",value:function(p){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,w=c.getUniqueValues(p);if(w.length<y)return!1;w.includes(13)&&w.push(0);for(var _=[w[0]],b=1;b<w.length&&_.length<y;b++)(0,r.last)(_)-w[b]===1?_.push(w[b]):_=[w[b]];return _.length==y?_.map(function(D){return p.find(function(E){return E.value===(D||13)})}):!1}},{key:"isTwoPairs",value:function(p){return c.isNumOfAKindCombination([2,2],p)}}]),c}();m(v,"Rank",h);var T=v;t.default=T})(kt);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Card",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"Deck",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"Hand",{enumerable:!0,get:function(){return r.default}});var e=l(ye),n=l(wt),r=l(kt);function l(i){return i&&i.__esModule?i:{default:i}}})(te);function Sn(t){let e,n;return{c(){e=ke("svg"),n=ke("path"),S(n,"d",t[1]),S(n,"fill","CurrentColor"),S(e,"viewBox","0 0 16 20"),S(e,"class","svelte-1jimf84"),L(e,"flip",t[0])},m(r,l){q(r,e,l),O(e,n)},p(r,[l]){l&2&&S(n,"d",r[1]),l&1&&L(e,"flip",r[0])},i:I,o:I,d(r){r&&N(e)}}}function wn(t,e,n){let r,{suit:l=null}=e,{flip:i=!1}=e;const s=o=>{switch(o){case"hearts":return"M 8 2 C 9 0 11 0 12 0 C 13 0 16 1 16 6 C 16 8 15.5 10 14 12 L 8 20 L 2 12 C 0.5 10 0 8 0 6 C 0 1 3 0 4 0 C 5 0 7 0 8 2";case"spades":return"M 8 0 L 13 5 C 16 8 16 10 16 12 C 16 14 14 16 12 16 C 11 16 9 16 8 14 L 12 20 L 4 20 L 8 14 C 7 16 5 16 4 16 C 2 16 0 14 0 12 C 0 10 0 8 3 5 L 8 0";case"diamonds":return"M 8 0 L 16 10 L 8 20 L 0 10 L 8 0";case"clubs":return"M 8 0 C 10 0 12 2 12 4 C 12 6 11 8 8 10 C 9 8 10 7 12 7 C 14 7 16 9 16 12 C 16 14 14 16 12 16 C 11 16 9 16 8 14 L 12 20 L 4 20 L 8 14 C 7 16 5 16 4 16 C 2 16 0 14 0 12 C 0 9 2 7 4 7 C 6 7 7 8 8 10 C 5 8 4 6 4 4 C 4 2 6 0 8 0";default:return null}};return t.$$set=o=>{"suit"in o&&n(2,l=o.suit),"flip"in o&&n(0,i=o.flip)},t.$$.update=()=>{t.$$.dirty&4&&n(1,r=s(l))},[i,r,l]}class Ct extends G{constructor(e){super(),B(this,e,wn,Sn,W,{suit:2,flip:0})}}function Ye(t,e,n){const r=t.slice();return r[5]=e[n],r}function Ze(t,e,n){const r=t.slice();return r[8]=e[n],r}function $e(t){let e,n,r;return n=new Ct({props:{suit:t[0],flip:t[8].toLowerCase()==="d"}}),{c(){e=F("span"),K(n.$$.fragment),S(e,"class","svelte-1sm49dl")},m(l,i){q(l,e,i),M(n,e,null),r=!0},p(l,i){const s={};i&1&&(s.suit=l[0]),i&2&&(s.flip=l[8].toLowerCase()==="d"),n.$set(s)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(e),z(n)}}}function xe(t){let e,n,r,l,i=X(t[5].split("")),s=[];for(let f=0;f<i.length;f+=1)s[f]=$e(Ze(t,i,f));const o=f=>A(s[f],1,1,()=>{s[f]=null});return{c(){e=F("div");for(let f=0;f<s.length;f+=1)s[f].c();n=V(),S(e,"class",r="row "+t[3](t[5])+" svelte-1sm49dl")},m(f,u){q(f,e,u);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(e,null);O(e,n),l=!0},p(f,u){if(u&7){i=X(f[5].split(""));let g;for(g=0;g<i.length;g+=1){const d=Ze(f,i,g);s[g]?(s[g].p(d,u),C(s[g],1)):(s[g]=$e(d),s[g].c(),C(s[g],1),s[g].m(e,n))}for(Y(),g=i.length;g<s.length;g+=1)o(g);Z()}(!l||u&2&&r!==(r="row "+f[3](f[5])+" svelte-1sm49dl"))&&S(e,"class",r)},i(f){if(!l){for(let u=0;u<i.length;u+=1)C(s[u]);l=!0}},o(f){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)A(s[u]);l=!1},d(f){f&&N(e),ge(s,f)}}}function kn(t){let e,n,r=X(t[2](t[1])),l=[];for(let s=0;s<r.length;s+=1)l[s]=xe(Ye(t,r,s));const i=s=>A(l[s],1,1,()=>{l[s]=null});return{c(){e=F("div");for(let s=0;s<l.length;s+=1)l[s].c();S(e,"class","center-pattern svelte-1sm49dl")},m(s,o){q(s,e,o);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);n=!0},p(s,[o]){if(o&15){r=X(s[2](s[1]));let f;for(f=0;f<r.length;f+=1){const u=Ye(s,r,f);l[f]?(l[f].p(u,o),C(l[f],1)):(l[f]=xe(u),l[f].c(),C(l[f],1),l[f].m(e,null))}for(Y(),f=r.length;f<l.length;f+=1)i(f);Z()}},i(s){if(!n){for(let o=0;o<r.length;o+=1)C(l[o]);n=!0}},o(s){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)A(l[o]);n=!1},d(s){s&&N(e),ge(l,s)}}}function Cn(t,e,n){let{suit:r}=e,{rank:l}=e;const i={A:["U"],2:["U","D"],3:["U","U","D"],4:["UU","DD"],5:["UU","U","DD"],6:["UU","UU","DD"],7:["UU","u","UU","DD"],8:["UU","UU","DD","DD"],9:["UU","u","UU","DD","DD"],10:["UU","u","UU","DD","d","DD"]},s=f=>i[f]??[],o=f=>f.toUpperCase()===f?"grow":"";return t.$$set=f=>{"suit"in f&&n(0,r=f.suit),"rank"in f&&n(1,l=f.rank)},[r,l,s,o]}class Dn extends G{constructor(e){super(),B(this,e,Cn,kn,W,{suit:0,rank:1})}}function An(t){let e,n;const r=t[1].default,l=Kt(r,t,t[0],null);return{c(){e=F("span"),l&&l.c(),S(e,"class","screen-reader-only svelte-3uotpv")},m(i,s){q(i,e,s),l&&l.m(e,null),n=!0},p(i,[s]){l&&l.p&&(!n||s&1)&&jt(l,r,i,i[0],n?qt(r,i[0],s,null):Vt(i[0]),null)},i(i){n||(C(l,i),n=!0)},o(i){A(l,i),n=!1},d(i){i&&N(e),l&&l.d(i)}}}function On(t,e,n){let{$$slots:r={},$$scope:l}=e;return t.$$set=i=>{"$$scope"in i&&n(0,l=i.$$scope)},[l,r]}class Tn extends G{constructor(e){super(),B(this,e,On,An,W,{})}}function et(t,e,n){const r=t.slice();return r[16]=e[n],r}function tt(t){let e,n;return e=new Tn({props:{$$slots:{default:[En]},$$scope:{ctx:t}}}),{c(){K(e.$$.fragment)},m(r,l){M(e,r,l),n=!0},p(r,l){const i={};l&524320&&(i.$$scope={dirty:l,ctx:r}),e.$set(i)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function En(t){let e;return{c(){e=$(t[5])},m(n,r){q(n,e,r)},p(n,r){r&32&&De(e,n[5])},d(n){n&&N(e)}}}function nt(t){let e,n;return e=new Dn({props:{suit:t[7],rank:t[8]}}),{c(){K(e.$$.fragment)},m(r,l){M(e,r,l),n=!0},p(r,l){const i={};l&128&&(i.suit=r[7]),l&256&&(i.rank=r[8]),e.$set(i)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function rt(t){let e,n,r,l,i,s,o,f,u,g,d;o=new Ct({props:{suit:t[7]}});let a=!t[10]&&nt(t);return{c(){e=F("div"),n=F("div"),r=$(t[8]),i=V(),s=F("div"),K(o.$$.fragment),f=V(),u=F("div"),a&&a.c(),g=V(),S(n,"class",l="rank rank-"+t[8]+" svelte-t2vtqs"),S(s,"class","suit svelte-t2vtqs"),S(e,"aria-hidden","true"),S(e,"class",t[16]+" label svelte-t2vtqs"),S(u,"class","center svelte-t2vtqs"),L(u,"face",t[6])},m(m,h){q(m,e,h),O(e,n),O(n,r),O(e,i),O(e,s),M(o,s,null),q(m,f,h),q(m,u,h),a&&a.m(u,null),O(u,g),d=!0},p(m,h){(!d||h&256)&&De(r,m[8]),(!d||h&256&&l!==(l="rank rank-"+m[8]+" svelte-t2vtqs"))&&S(n,"class",l);const v={};h&128&&(v.suit=m[7]),o.$set(v),m[10]?a&&(Y(),A(a,1,1,()=>{a=null}),Z()):a?(a.p(m,h),h&1024&&C(a,1)):(a=nt(m),a.c(),C(a,1),a.m(u,g)),(!d||h&64)&&L(u,"face",m[6])},i(m){d||(C(o.$$.fragment,m),C(a),d=!0)},o(m){A(o.$$.fragment,m),A(a),d=!1},d(m){m&&(N(e),N(f),N(u)),z(o),a&&a.d()}}}function Fn(t){let e,n,r,l,i=t[3]&&tt(t),s=X(t[13]),o=[];for(let u=0;u<s.length;u+=1)o[u]=rt(et(t,s,u));const f=u=>A(o[u],1,1,()=>{o[u]=null});return{c(){e=F("div"),i&&i.c(),n=V();for(let u=0;u<o.length;u+=1)o[u].c();S(e,"class",r="card "+t[7]+" stack-"+t[2]+" svelte-t2vtqs"),L(e,"bridge",t[11]),L(e,"small",t[10]),L(e,"fourColor",t[9]),L(e,"empty",t[0]),L(e,"hidden",t[4]),L(e,"shadow",t[1]),L(e,"visible",t[3])},m(u,g){q(u,e,g),i&&i.m(e,null),O(e,n);for(let d=0;d<o.length;d+=1)o[d]&&o[d].m(e,null);l=!0},p(u,[g]){if(u[3]?i?(i.p(u,g),g&8&&C(i,1)):(i=tt(u),i.c(),C(i,1),i.m(e,n)):i&&(Y(),A(i,1,1,()=>{i=null}),Z()),g&9664){s=X(u[13]);let d;for(d=0;d<s.length;d+=1){const a=et(u,s,d);o[d]?(o[d].p(a,g),C(o[d],1)):(o[d]=rt(a),o[d].c(),C(o[d],1),o[d].m(e,null))}for(Y(),d=s.length;d<o.length;d+=1)f(d);Z()}(!l||g&132&&r!==(r="card "+u[7]+" stack-"+u[2]+" svelte-t2vtqs"))&&S(e,"class",r),(!l||g&2180)&&L(e,"bridge",u[11]),(!l||g&1156)&&L(e,"small",u[10]),(!l||g&644)&&L(e,"fourColor",u[9]),(!l||g&133)&&L(e,"empty",u[0]),(!l||g&148)&&L(e,"hidden",u[4]),(!l||g&134)&&L(e,"shadow",u[1]),(!l||g&140)&&L(e,"visible",u[3])},i(u){if(!l){C(i);for(let g=0;g<s.length;g+=1)C(o[g]);l=!0}},o(u){A(i),o=o.filter(Boolean);for(let g=0;g<o.length;g+=1)A(o[g]);l=!1},d(u){u&&N(e),i&&i.d(),ge(o,u)}}}function Ln(t,e,n){let r,l,i,s,o,f,u,g,d,a;const m=Me();ne(t,m,p=>n(15,a=p));let{card:h=null}=e,{empty:v=!1}=e,{shadow:T=!1}=e,{stack:c=void 0}=e;const k=["top","bottom"];return t.$$set=p=>{"card"in p&&n(14,h=p.card),"empty"in p&&n(0,v=p.empty),"shadow"in p&&n(1,T=p.shadow),"stack"in p&&n(2,c=p.stack)},t.$$.update=()=>{t.$$.dirty&32768&&n(11,r=a.size==="bridge"),t.$$.dirty&32768&&n(10,l=a.size==="small"),t.$$.dirty&32768&&n(9,i=a.fourColor),t.$$.dirty&16386&&n(4,s=h===null&&!T),t.$$.dirty&19&&n(3,o=!(v||s||T)),t.$$.dirty&16392&&n(8,f=o&&h.toString(te.Card.StringType.ShortValue).replace("T","10")),t.$$.dirty&16392&&n(7,u=o&&h.toString(te.Card.StringType.LongSuit)),t.$$.dirty&16392&&n(6,g=o&&h.num%13>9),t.$$.dirty&16392&&n(5,d=o&&h.toString(te.Card.StringType.Long))},[v,T,c,o,s,d,g,u,f,i,l,r,m,k,h,a]}class Oe extends G{constructor(e){super(),B(this,e,Ln,Fn,W,{card:14,empty:0,shadow:1,stack:2})}}function lt(t,e,n){const r=t.slice();return r[19]=e[n].card,r[20]=e[n].shadow,r[21]=e[n].transform,r}function it(t){let e,n;return e=new Oe({props:{card:t[0],empty:t[0]===void 0}}),{c(){K(e.$$.fragment)},m(r,l){M(e,r,l),n=!0},p(r,l){const i={};l&1&&(i.card=r[0]),l&1&&(i.empty=r[0]===void 0),e.$set(i)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function st(t){let e,n,r,l;return n=new Oe({props:{card:t[19],shadow:t[20]}}),{c(){e=F("div"),K(n.$$.fragment),r=V(),S(e,"class","shadow-container svelte-1ns87h6"),Je(e,"transform",t[21])},m(i,s){q(i,e,s),M(n,e,null),O(e,r),l=!0},p(i,s){const o={};s&8&&(o.card=i[19]),s&8&&(o.shadow=i[20]),n.$set(o),(!l||s&8)&&Je(e,"transform",i[21])},i(i){l||(C(n.$$.fragment,i),l=!0)},o(i){A(n.$$.fragment,i),l=!1},d(i){i&&N(e),z(n)}}}function Pn(t){let e,n,r,l,i,s,o=!t[1]&&it(t),f=X(t[3]),u=[];for(let d=0;d<f.length;d+=1)u[d]=st(lt(t,f,d));const g=d=>A(u[d],1,1,()=>{u[d]=null});return{c(){e=F("div"),n=F("div"),o&&o.c(),r=V();for(let d=0;d<u.length;d+=1)u[d].c();S(n,"aria-atomic","true"),S(n,"aria-live","polite"),S(e,"aria-label",t[2]),S(e,"aria-disabled",t[1]),S(e,"class","deck svelte-1ns87h6"),S(e,"role","button"),S(e,"tabindex","0"),L(e,"bridge",t[5]),L(e,"small",t[4]),L(e,"shuffling",t[1])},m(d,a){q(d,e,a),O(e,n),o&&o.m(n,null),O(n,r);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(n,null);l=!0,i||(s=[H(e,"keydown",Pe(["Space","Enter"],t[7],{preventDefault:!0})),H(e,"click",t[7])],i=!0)},p(d,[a]){if(d[1]?o&&(Y(),A(o,1,1,()=>{o=null}),Z()):o?(o.p(d,a),a&2&&C(o,1)):(o=it(d),o.c(),C(o,1),o.m(n,r)),a&8){f=X(d[3]);let m;for(m=0;m<f.length;m+=1){const h=lt(d,f,m);u[m]?(u[m].p(h,a),C(u[m],1)):(u[m]=st(h),u[m].c(),C(u[m],1),u[m].m(n,null))}for(Y(),m=f.length;m<u.length;m+=1)g(m);Z()}(!l||a&4)&&S(e,"aria-label",d[2]),(!l||a&2)&&S(e,"aria-disabled",d[1]),(!l||a&32)&&L(e,"bridge",d[5]),(!l||a&16)&&L(e,"small",d[4]),(!l||a&2)&&L(e,"shuffling",d[1])},i(d){if(!l){C(o);for(let a=0;a<f.length;a+=1)C(u[a]);l=!0}},o(d){A(o),u=u.filter(Boolean);for(let a=0;a<u.length;a+=1)A(u[a]);l=!1},d(d){d&&N(e),o&&o.d(),ge(u,d),i=!1,re(s)}}}function Un(t,e,n,r){const l=t/r*e,i=.5*l/(n*52),s=1*l/(n*52);return`translate(${i}em , ${s}em)`}function Nn(t,e,n){let r,l,i,s,o,f;const u=Me();ne(t,u,_=>n(16,f=_));let{numCards:g=52}=e,{numDecks:d=1}=e,{topCard:a=null}=e,{numShadows:m=10}=e,{shuffleAnimationSteps:h=4}=e,{shuffleAnimationMaxDistanceEm:v=.8}=e,{shuffleAnimationMaxRotateDeg:T=7}=e,{onClick:c=()=>{}}=e,k=0;function p(_,b){const D=Q=>[1,b+2].includes(_)?0:(Math.random()*2-1)*Q,E=D(v),U=D(v),j=D(T);return`translate(${E}em, ${U}em) rotate(${j}deg)`}function y(){k>0&&setTimeout(()=>{n(15,k-=1),y()},250)}function w(){if(!s)return c()}return t.$$set=_=>{"numCards"in _&&n(8,g=_.numCards),"numDecks"in _&&n(9,d=_.numDecks),"topCard"in _&&n(0,a=_.topCard),"numShadows"in _&&n(10,m=_.numShadows),"shuffleAnimationSteps"in _&&n(11,h=_.shuffleAnimationSteps),"shuffleAnimationMaxDistanceEm"in _&&n(12,v=_.shuffleAnimationMaxDistanceEm),"shuffleAnimationMaxRotateDeg"in _&&n(13,T=_.shuffleAnimationMaxRotateDeg),"onClick"in _&&n(14,c=_.onClick)},t.$$.update=()=>{t.$$.dirty&65536&&n(5,r=(f==null?void 0:f.size)==="bridge"),t.$$.dirty&65536&&n(4,l=(f==null?void 0:f.size)==="small"),t.$$.dirty&2817&&a===null&&g===52*d&&h>0&&(n(15,k=h+2),y()),t.$$.dirty&32768&&n(1,s=k>0),t.$$.dirty&36611&&n(3,i=a===void 0?[]:s?[...Array(m)].map((_,b)=>({card:null,shadow:!1,transform:p(k,h)})):[...Array(m)].map((_,b)=>({card:void 0,shadow:!0,transform:Un(b,g,d,m)}))),t.$$.dirty&1&&n(2,o=a===void 0?"Shuffle the deck":"Draw a card")},[a,s,o,i,l,r,u,w,g,d,m,h,v,T,c,k,f]}class Mn extends G{constructor(e){super(),B(this,e,Nn,Pn,W,{numCards:8,numDecks:9,topCard:0,numShadows:10,shuffleAnimationSteps:11,shuffleAnimationMaxDistanceEm:12,shuffleAnimationMaxRotateDeg:13,onClick:14})}}function zn(t){let e,n,r;return n=new Mn({props:{onClick:t[2],topCard:t[1],numCards:t[0]}}),{c(){e=F("main"),K(n.$$.fragment),S(e,"class","svelte-1tag1lj")},m(l,i){q(l,e,i),M(n,e,null),r=!0},p(l,[i]){const s={};i&2&&(s.topCard=l[1]),i&1&&(s.numCards=l[0]),n.$set(s)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(e),z(n)}}}function Kn(t,e,n){St(fn);let r=new te.Deck,l=r.cardsRemaining,i=null;function s(){i!==void 0?n(1,i=r.pop()):(r=new te.Deck,n(1,i=null)),n(0,l=r.cardsRemaining)}return[l,i,s]}class qn extends G{constructor(e){super(),B(this,e,Kn,zn,W,{})}}const Dt=(t,e)=>yt(e).width+(t-1)*1.125,jn=(t,e,n)=>{const r={sourceStack:e,cards:n};t.dataTransfer.setData("application/json",JSON.stringify(r)),t.dataTransfer.effectAllowed="move"},Vn=t=>{const{sourceStack:e,cards:n}=JSON.parse(t.dataTransfer.getData("application/json"));return{sourceStack:e,cards:n.map(te.Card.fromJSON)}};function Rn(t){let e,n;return e=new Oe({props:{card:t[10]?null:t[0][0],stack:"left"}}),{c(){K(e.$$.fragment)},m(r,l){M(e,r,l),n=!0},p(r,l){const i={};l&1025&&(i.card=r[10]?null:r[0][0]),e.$set(i)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function In(t){let e,n;return e=new Oe({props:{empty:!0}}),{c(){K(e.$$.fragment)},m(r,l){M(e,r,l),n=!0},p:I,i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function ut(t){let e,n,r;return n=new At({props:{cards:t[0].slice(1),capacity:t[1]-1,nested:!0,closed:t[2],index:t[3],isDraggableFn:t[4],selectedCardsN:t[5]}}),{c(){e=F("div"),K(n.$$.fragment),S(e,"class","nested svelte-o50ay1")},m(l,i){q(l,e,i),M(n,e,null),r=!0},p(l,i){const s={};i&1&&(s.cards=l[0].slice(1)),i&2&&(s.capacity=l[1]-1),i&4&&(s.closed=l[2]),i&8&&(s.index=l[3]),i&16&&(s.isDraggableFn=l[4]),i&32&&(s.selectedCardsN=l[5]),n.$set(s)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(e),z(n)}}}function Hn(t){let e,n,r,l,i,s,o,f;const u=[In,Rn],g=[];function d(m,h){return m[0].length===0?0:1}n=d(t),r=g[n]=u[n](t);let a=t[0].length>1&&ut(t);return{c(){e=F("div"),r.c(),l=V(),a&&a.c(),S(e,"class","stack svelte-o50ay1"),S(e,"style",t[13]),S(e,"draggable",t[12]),S(e,"tabindex",i=t[6]?void 0:0),L(e,"selected",t[11])},m(m,h){q(m,e,h),g[n].m(e,null),O(e,l),a&&a.m(e,null),s=!0,o||(f=[H(e,"dblclick",t[17]),H(e,"dragstart",function(){ee(t[9])&&t[9].apply(this,arguments)}),H(e,"dragover",function(){ee(t[8])&&t[8].apply(this,arguments)}),H(e,"drop",t[18]),H(e,"click",function(){ee(t[7])&&t[7].apply(this,arguments)}),H(e,"keydown",function(){ee(Pe(["Enter","Space"],t[7],{preventDefault:!0}))&&Pe(["Enter","Space"],t[7],{preventDefault:!0}).apply(this,arguments)})],o=!0)},p(m,[h]){t=m;let v=n;n=d(t),n===v?g[n].p(t,h):(Y(),A(g[v],1,1,()=>{g[v]=null}),Z(),r=g[n],r?r.p(t,h):(r=g[n]=u[n](t),r.c()),C(r,1),r.m(e,l)),t[0].length>1?a?(a.p(t,h),h&1&&C(a,1)):(a=ut(t),a.c(),C(a,1),a.m(e,null)):a&&(Y(),A(a,1,1,()=>{a=null}),Z()),(!s||h&8192)&&S(e,"style",t[13]),(!s||h&4096)&&S(e,"draggable",t[12]),(!s||h&64&&i!==(i=t[6]?void 0:0))&&S(e,"tabindex",i),(!s||h&2048)&&L(e,"selected",t[11])},i(m){s||(C(r),C(a),s=!0)},o(m){A(r),A(a),s=!1},d(m){m&&N(e),g[n].d(),a&&a.d(),o=!1,re(f)}}}function Jn(t,e,n){let r,l,i,s,o,f,u,g,d;const a=Me();ne(t,a,b=>n(16,d=b));let{cards:m=[]}=e,{capacity:h=4}=e,{closed:v=!1}=e,{index:T=0}=e,{isDraggableFn:c=()=>!1}=e,{selectedCardsN:k=0}=e,{nested:p=!1}=e;const y=Gt();function w(b){Be.call(this,t,b)}function _(b){Be.call(this,t,b)}return t.$$set=b=>{"cards"in b&&n(0,m=b.cards),"capacity"in b&&n(1,h=b.capacity),"closed"in b&&n(2,v=b.closed),"index"in b&&n(3,T=b.index),"isDraggableFn"in b&&n(4,c=b.isDraggableFn),"selectedCardsN"in b&&n(5,k=b.selectedCardsN),"nested"in b&&n(6,p=b.nested)},t.$$.update=()=>{t.$$.dirty&65536&&n(15,r=d.size),t.$$.dirty&32770&&n(13,l=`width: ${Dt(h,r)}em`),t.$$.dirty&21&&n(12,i=!v&&c(m)),t.$$.dirty&33&&n(11,s=k>0&&k===m.length),t.$$.dirty&5&&n(10,o=v&&m.length===1),t.$$.dirty&9&&n(9,f=b=>{b.stopPropagation(),jn(b,T,m)}),t.$$.dirty&72&&n(7,g=()=>{p||y("select",{index:T})})},n(8,u=b=>{b.preventDefault()}),[m,h,v,T,c,k,p,g,u,f,o,s,i,l,a,r,d,w,_]}class At extends G{constructor(e){super(),B(this,e,Jn,Hn,W,{cards:0,capacity:1,closed:2,index:3,isDraggableFn:4,selectedCardsN:5,nested:6})}}const Ot=(t,e)=>{const n=t/e;return n<3/4?[3,5]:n<4/3?[4,4]:[5,3]},ot=(t,e)=>{const[n,r]=Ot(t,e);return{length:n*r-15}},Wn=(t,e,n,r)=>{const[l,i]=Ot(e,r),s=Dt(4,t)*l+(t!=="small"?.666:.333)*10,o=e*.95/s,f=yt(t).height*i+(t!=="small"?.5:.25)*6,g=(n>600?n:r)*.95/f;return Math.min(o,g)},Bn=()=>{const t=new te.Deck;return[...Array(13)].map(()=>t.popN(4)).concat([[],[]])},ze=t=>{const[e,...n]=t;return n.every(r=>r.value===e.value)},Gn=t=>t.length===0?!1:t.length===1?!0:ze(t),Tt=(t,e)=>t.length+e.length>4?!1:e.length===0||e[e.length-1].value===t[0].value,Et=(t,e,n,r)=>{const l=t.map(i=>[...i]);if(!Tt(r,l[n]))throw new Error(`Can not move cards ${r.map(i=>i.toString(ye.CardStringType.ShortEmoji))} from pile ${e} to pile ${n}`);return l[e]=l[e].slice(0,l[e].length-r.length),l[n]=[...l[n],...r],l},Ke=t=>t.length===1||ze(t)?t:Ke(t.slice(1)),Qn=(t,e)=>{if(t[e].length===0)throw new Error("Cannot move cards from an empty pile.");if(Ft(t[e]))throw new Error("Cannot move cards from a completed pile.");const n=Ke(t[e]),r=t.reduce((s,o,f)=>f!==e&&Tt(n,o)?[...s,f]:s,[]);if(r.length===0)throw new Error(`Cannot move cards from pile ${e} to any other pile`);const l=r.filter(s=>t[s].length>0),i=l.length>0?l[0]:r[0];return Et(t,e,i,n)},Ft=t=>t.length===4&&ze(t),Xn=t=>t.reduce((e,n,r)=>Ft(n)?[...e,r]:e,[]);function at(t,e,n){const r=t.slice();return r[21]=e[n],r}function ft(t,e,n){const r=t.slice();return r[24]=e[n],r[26]=n,r}function ct(t){let e,n,r;return n=new At({props:{cards:t[24],closed:t[8].includes(t[26]),selectedCardsN:t[7]===t[26]?t[6].length:0,index:t[26],isDraggableFn:Gn}}),n.$on("drop",t[11](t[26])),n.$on("dblclick",t[12](t[26])),n.$on("select",t[10]),{c(){e=F("div"),K(n.$$.fragment),S(e,"class","pile svelte-1qdb0j4"),L(e,"small",t[3]==="small")},m(l,i){q(l,e,i),M(n,e,null),r=!0},p(l,i){const s={};i&16&&(s.cards=l[24]),i&256&&(s.closed=l[8].includes(l[26])),i&192&&(s.selectedCardsN=l[7]===l[26]?l[6].length:0),n.$set(s),(!r||i&8)&&L(e,"small",l[3]==="small")},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(e),z(n)}}}function dt(t){let e;return{c(){e=F("div"),S(e,"class","pile svelte-1qdb0j4")},m(n,r){q(n,e,r)},p:I,d(n){n&&N(e)}}}function Yn(t){let e,n,r,l,i,s;ve(t[17]);let o=X(t[4]),f=[];for(let a=0;a<o.length;a+=1)f[a]=ct(ft(t,o,a));const u=a=>A(f[a],1,1,()=>{f[a]=null});let g=X(ot(t[0],t[2])),d=[];for(let a=0;a<g.length;a+=1)d[a]=dt(at(t,g,a));return{c(){e=F("main");for(let a=0;a<f.length;a+=1)f[a].c();n=V();for(let a=0;a<d.length;a+=1)d[a].c();S(e,"class","pileon svelte-1qdb0j4"),S(e,"style",t[5]),ve(()=>t[18].call(e))},m(a,m){q(a,e,m);for(let h=0;h<f.length;h+=1)f[h]&&f[h].m(e,null);O(e,n);for(let h=0;h<d.length;h+=1)d[h]&&d[h].m(e,null);r=Ht(e,t[18].bind(e)),l=!0,i||(s=H(window,"resize",t[17]),i=!0)},p(a,[m]){if(m&7640){o=X(a[4]);let h;for(h=0;h<o.length;h+=1){const v=ft(a,o,h);f[h]?(f[h].p(v,m),C(f[h],1)):(f[h]=ct(v),f[h].c(),C(f[h],1),f[h].m(e,n))}for(Y(),h=o.length;h<f.length;h+=1)u(h);Z()}if(m&5){g=X(ot(a[0],a[2]));let h;for(h=0;h<g.length;h+=1){const v=at(a,g,h);d[h]?d[h].p(v,m):(d[h]=dt(),d[h].c(),d[h].m(e,null))}for(;h<d.length;h+=1)d[h].d(1);d.length=g.length}(!l||m&32)&&S(e,"style",a[5])},i(a){if(!l){for(let m=0;m<o.length;m+=1)C(f[m]);l=!0}},o(a){f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)A(f[m]);l=!1},d(a){a&&N(e),ge(f,a),ge(d,a),r(),i=!1,s()}}}function Zn(t,e,n){let r,l,i,s,o,f,u,g,d,a,m,h=St(D=>({size:D.size==="default"?"bridge":D.size,fourColor:D.colors==="four-color"}));ne(t,h,D=>n(16,g=D));let v=[Bn()];const T=D=>{D.stopPropagation(),v.length>1&&n(13,v=v.slice(0,v.length-1))};let c=[void 0,[]];const k=(D,E,U)=>{try{n(14,c=[void 0,[]]);const j=Et(v[v.length-1],D,E,U);n(13,v=[...v,j])}catch{}},p=D=>{const[E,U]=c,j=D.detail.index;l.includes(j)||(E===void 0||U.length===0?n(14,c=[j,Ke(r[j])]):E===j?n(14,c=[j,U.slice(1)]):E!==j&&(k(E,j,U),n(14,c=[void 0,[]])))},y=D=>E=>{E.preventDefault();const{sourceStack:U,cards:j}=Vn(E);U!==D&&k(U,D,j)},w=D=>E=>{E.preventDefault();try{n(14,c=[void 0,[]]);const U=Qn(v[v.length-1],D);n(13,v=[...v,U])}catch{}};Wt(()=>{Ce.update(D=>({...D,undo:T}))}),Bt(()=>{Ce.update(D=>({...D,undo:void 0}))});function _(){n(2,m=window.innerHeight)}function b(){a=this.clientHeight,d=this.clientWidth,n(1,a),n(0,d)}return t.$$.update=()=>{if(t.$$.dirty&5){const D=d<800||m<500?"small":"bridge";cn(E=>({size:E.size==="default"?D:E.size,fourColor:E.colors==="four-color"}))}t.$$.dirty&8192&&n(4,r=v[v.length-1]),t.$$.dirty&16&&n(8,l=Xn(r)),t.$$.dirty&16384&&n(7,i=c[0]),t.$$.dirty&16384&&n(6,s=c[1]),t.$$.dirty&65536&&n(3,o=g.size),t.$$.dirty&15&&n(15,f=Wn(o,d,a,m)),t.$$.dirty&32768&&n(5,u=`font-size: ${f}px`)},[d,a,m,o,r,u,s,i,l,h,p,y,w,v,c,f,g,_,b]}class $n extends G{constructor(e){super(),B(this,e,Zn,Yn,W,{})}}function xn(t){let e;return{c(){e=F("span"),e.textContent=`at ${t[0]} ${t[1]}`},m(n,r){q(n,e,r)},p:I,d(n){n&&N(e)}}}function er(t){let e,n,r,l=(t[1]||t[0])&&xn(t);return{c(){e=F("footer"),n=F("a"),n.textContent="kangasta / pileon",r=V(),l&&l.c(),S(n,"href","https://github.com/kangasta/pileon.git"),S(n,"target","_blank"),S(e,"class","svelte-16t3ryr")},m(i,s){q(i,e,s),O(e,n),O(e,r),l&&l.m(e,null)},p(i,[s]){(i[1]||i[0])&&l.p(i,s)},i:I,o:I,d(i){i&&N(e),l&&l.d()}}}function tr(t){const e={}.VITE_TAG??"",n="378ce77bdc801e91e3172a0f9bafba3cece22a01".slice(0,8);return[e,n]}class nr extends G{constructor(e){super(),B(this,e,tr,er,W,{})}}const rr=()=>(Math.random()+1).toString(36).substring(5);function lr(t){let e,n,r,l,i,s,o,f,u,g,d;return{c(){e=F("div"),n=F("button"),r=ke("svg"),l=ke("path"),o=V(),f=F("div"),u=$(t[1]),S(l,"fill","none"),S(l,"stroke","currentColor"),S(l,"stroke-linecap","round"),S(l,"stroke-linejoin","round"),S(l,"stroke-width","1"),S(l,"d",i=t[3][t[0]].path),S(r,"viewBox","0 0 16 16 "),S(r,"class",s=He(t[3][t[0]].class)+" svelte-173olzb"),S(n,"aria-labelledby",t[4]),S(n,"class","clickable svelte-173olzb"),L(n,"open",open),S(f,"class","label svelte-173olzb"),S(f,"id",t[4]),S(e,"class","icon-button clickable svelte-173olzb")},m(a,m){q(a,e,m),O(e,n),O(n,r),O(r,l),O(e,o),O(e,f),O(f,u),g||(d=[H(n,"click",function(){ee(t[2])&&t[2].apply(this,arguments)}),H(e,"click",function(){ee(t[2])&&t[2].apply(this,arguments)})],g=!0)},p(a,[m]){t=a,m&1&&i!==(i=t[3][t[0]].path)&&S(l,"d",i),m&1&&s!==(s=He(t[3][t[0]].class)+" svelte-173olzb")&&S(r,"class",s),m&0&&L(n,"open",open),m&2&&De(u,t[1])},i:I,o:I,d(a){a&&N(e),g=!1,re(d)}}}function ir(t,e,n){const r={Undo:{path:"M 6 2 L 2 6 L 6 10 M 2 6 L 10 6 A 4 4 0 1 1 10 14 L 8 14"},ChevronDown:{path:"M 4 6 L 8 10 L 12 6",class:"transition-transform"},ChevronUp:{path:"M 4 6 L 8 10 L 12 6",class:"transition-transform mirror-y"}};let{icon:l}=e,{label:i}=e,{onClick:s}=e;const o=`${rr()}-label`;return t.$$set=f=>{"icon"in f&&n(0,l=f.icon),"label"in f&&n(1,i=f.label),"onClick"in f&&n(2,s=f.onClick)},[l,i,s,r,o]}class Lt extends G{constructor(e){super(),B(this,e,ir,lr,W,{icon:0,label:1,onClick:2})}}function sr(t){let e,n,r,l,i;return{c(){e=F("button"),n=$(t[0]),S(e,"aria-pressed",r=t[1]?"true":"false"),e.disabled=t[1],S(e,"class","svelte-jc3xzr"),L(e,"pressed",t[1])},m(s,o){q(s,e,o),O(e,n),l||(i=H(e,"click",function(){ee(t[2])&&t[2].apply(this,arguments)}),l=!0)},p(s,[o]){t=s,o&1&&De(n,t[0]),o&2&&r!==(r=t[1]?"true":"false")&&S(e,"aria-pressed",r),o&2&&(e.disabled=t[1]),o&2&&L(e,"pressed",t[1])},i:I,o:I,d(s){s&&N(e),l=!1,i()}}}function ur(t,e,n){let r,l,i;ne(t,he,g=>n(4,i=g));let{target:s}=e,{value:o}=e;const{update:f}=he,u=()=>{};return t.$$set=g=>{"target"in g&&n(3,s=g.target),"value"in g&&n(0,o=g.value)},t.$$.update=()=>{t.$$.dirty&25&&n(1,l=i[s]===o),t.$$.dirty&11&&n(2,r=l?u:()=>f(g=>({...g,[s]:o})))},[o,l,r,s,i]}class x extends G{constructor(e){super(),B(this,e,ur,sr,W,{target:3,value:0})}}function gt(t){let e,n;return e=new Lt({props:{icon:"Undo",label:"Undo",onClick:t[2].undo}}),{c(){K(e.$$.fragment)},m(r,l){M(e,r,l),n=!0},p(r,l){const i={};l&4&&(i.onClick=r[2].undo),e.$set(i)},i(r){n||(C(e.$$.fragment,r),n=!0)},o(r){A(e.$$.fragment,r),n=!1},d(r){z(e,r)}}}function or(t){let e,n,r,l,i,s,o,f,u,g,d,a,m,h,v,T,c,k,p,y,w,_,b,D,E,U,j,Q,qe,ue,je,oe,Ve,le,Re,me;f=new x({props:{target:"game",value:"deck"}}),g=new x({props:{target:"game",value:"pileon"}}),T=new x({props:{target:"colors",value:"default"}}),k=new x({props:{target:"colors",value:"standard"}}),y=new x({props:{target:"colors",value:"four-color"}}),U=new x({props:{target:"size",value:"default"}}),Q=new x({props:{target:"size",value:"bridge"}}),ue=new x({props:{target:"size",value:"poker"}}),oe=new x({props:{target:"size",value:"small"}}),le=new Lt({props:{icon:t[0]?"ChevronUp":"ChevronDown",label:t[1],onClick:t[3]}});let R=t[2].undo!==void 0&&gt(t);return{c(){e=F("div"),n=F("div"),r=F("table"),l=F("tr"),i=F("th"),i.textContent="Game:",s=V(),o=F("td"),K(f.$$.fragment),u=$(" / "),K(g.$$.fragment),d=V(),a=F("tr"),m=F("th"),m.textContent="Colors:",h=V(),v=F("td"),K(T.$$.fragment),c=$(" / "),K(k.$$.fragment),p=$(" / "),K(y.$$.fragment),w=V(),_=F("tr"),b=F("th"),b.textContent="Size:",D=V(),E=F("td"),K(U.$$.fragment),j=$(" / "),K(Q.$$.fragment),qe=$(" / "),K(ue.$$.fragment),je=$(" / "),K(oe.$$.fragment),Ve=V(),K(le.$$.fragment),Re=V(),R&&R.c(),S(i,"class","svelte-eflwvb"),S(o,"class","svelte-eflwvb"),S(m,"class","svelte-eflwvb"),S(v,"class","svelte-eflwvb"),S(b,"class","svelte-eflwvb"),S(E,"class","svelte-eflwvb"),S(r,"class","svelte-eflwvb"),S(n,"class","content svelte-eflwvb"),L(n,"open",t[0]),S(e,"class","menu svelte-eflwvb")},m(P,ie){q(P,e,ie),O(e,n),O(n,r),O(r,l),O(l,i),O(l,s),O(l,o),M(f,o,null),O(o,u),M(g,o,null),O(r,d),O(r,a),O(a,m),O(a,h),O(a,v),M(T,v,null),O(v,c),M(k,v,null),O(v,p),M(y,v,null),O(r,w),O(r,_),O(_,b),O(_,D),O(_,E),M(U,E,null),O(E,j),M(Q,E,null),O(E,qe),M(ue,E,null),O(E,je),M(oe,E,null),O(e,Ve),M(le,e,null),O(e,Re),R&&R.m(e,null),me=!0},p(P,[ie]){(!me||ie&1)&&L(n,"open",P[0]);const Te={};ie&1&&(Te.icon=P[0]?"ChevronUp":"ChevronDown"),ie&2&&(Te.label=P[1]),le.$set(Te),P[2].undo!==void 0?R?(R.p(P,ie),ie&4&&C(R,1)):(R=gt(P),R.c(),C(R,1),R.m(e,null)):R&&(Y(),A(R,1,1,()=>{R=null}),Z())},i(P){me||(C(f.$$.fragment,P),C(g.$$.fragment,P),C(T.$$.fragment,P),C(k.$$.fragment,P),C(y.$$.fragment,P),C(U.$$.fragment,P),C(Q.$$.fragment,P),C(ue.$$.fragment,P),C(oe.$$.fragment,P),C(le.$$.fragment,P),C(R),me=!0)},o(P){A(f.$$.fragment,P),A(g.$$.fragment,P),A(T.$$.fragment,P),A(k.$$.fragment,P),A(y.$$.fragment,P),A(U.$$.fragment,P),A(Q.$$.fragment,P),A(ue.$$.fragment,P),A(oe.$$.fragment,P),A(le.$$.fragment,P),A(R),me=!1},d(P){P&&N(e),z(f),z(g),z(T),z(k),z(y),z(U),z(Q),z(ue),z(oe),z(le),R&&R.d()}}}function ar(t,e,n){let r,l;ne(t,Ce,o=>n(2,l=o));let i=!1;const s=o=>{n(0,i=!i),o.stopPropagation()};return t.$$.update=()=>{t.$$.dirty&1&&n(1,r=i?"Close menu":"Open menu")},[i,r,l,s]}class fr extends G{constructor(e){super(),B(this,e,ar,or,W,{})}}function cr(t){let e,n,r,l,i,s,o,f,u;e=new fr({});var g=t[0];function d(a,m){return{}}return g&&(r=We(g,d())),s=new nr({}),{c(){K(e.$$.fragment),n=V(),r&&K(r.$$.fragment),l=V(),i=V(),K(s.$$.fragment)},m(a,m){M(e,a,m),q(a,n,m),r&&M(r,a,m),q(a,l,m),q(a,i,m),M(s,a,m),o=!0,f||(u=H(document.body,"keydown",t[1]),f=!0)},p(a,[m]){if(m&1&&g!==(g=a[0])){if(r){Y();const h=r;A(h.$$.fragment,1,0,()=>{z(h,1)}),Z()}g?(r=We(g,d()),K(r.$$.fragment),C(r.$$.fragment,1),M(r,l.parentNode,l)):r=null}},i(a){o||(C(e.$$.fragment,a),r&&C(r.$$.fragment,a),C(s.$$.fragment,a),o=!0)},o(a){A(e.$$.fragment,a),r&&A(r.$$.fragment,a),A(s.$$.fragment,a),o=!1},d(a){a&&(N(n),N(l),N(i)),z(e,a),r&&z(r,a),z(s,a),f=!1,u()}}}function dr(t,e,n){let r,l,i;ne(t,Ce,o=>n(3,l=o)),ne(t,he,o=>n(2,i=o));const s=o=>{o.key==="z"&&(o.ctrlKey||o.metaKey)&&l.undo!==void 0&&l.undo(o)};return t.$$.update=()=>{t.$$.dirty&4&&n(0,r=i.game==="deck"?qn:$n)},[r,s,i]}class gr extends G{constructor(e){super(),B(this,e,dr,cr,W,{})}}new gr({target:document.body});

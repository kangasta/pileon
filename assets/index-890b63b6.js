var Ot=Object.defineProperty;var Tt=(e,t,n)=>t in e?Ot(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Ee=(e,t,n)=>(Tt(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();function j(){}function Et(e,t){for(const n in t)e[n]=t[n];return e}function ft(e){return e()}function je(){return Object.create(null)}function re(e){e.forEach(ft)}function Z(e){return typeof e=="function"}function H(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Pt(e){return Object.keys(e).length===0}function ct(e,...t){if(e==null){for(const r of t)r(void 0);return j}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function Ft(e){let t;return ct(e,n=>t=n)(),t}function ne(e,t,n){e.$$.on_destroy.push(ct(t,n))}function Lt(e,t,n,r){if(e){const l=dt(e,t,n,r);return e[0](l)}}function dt(e,t,n,r){return e[1]&&r?Et(n.ctx.slice(),e[1](r(t))):n.ctx}function Ut(e,t,n,r){if(e[2]&&r){const l=e[2](r(n));if(t.dirty===void 0)return l;if(typeof l=="object"){const i=[],u=Math.max(t.dirty.length,l.length);for(let a=0;a<u;a+=1)i[a]=t.dirty[a]|l[a];return i}return t.dirty|l}return t.dirty}function Nt(e,t,n,r,l,i){if(l){const u=dt(t,n,r,i);e.p(u,l)}}function Mt(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function Ie(e){return e??""}function A(e,t){e.appendChild(t)}function q(e,t,n){e.insertBefore(t,n||null)}function K(e){e.parentNode&&e.parentNode.removeChild(e)}function ve(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function P(e){return document.createElement(e)}function Se(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Y(e){return document.createTextNode(e)}function V(){return Y(" ")}function J(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function w(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function zt(e){return Array.from(e.childNodes)}function De(e,t){t=""+t,e.data!==t&&(e.data=t)}function He(e,t,n,r){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function F(e,t,n){e.classList.toggle(t,!!n)}function Kt(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}function Je(e,t){return new e(t)}let pe;function me(e){pe=e}function _e(){if(!pe)throw new Error("Function called outside component initialization");return pe}function qt(e){_e().$$.on_mount.push(e)}function Vt(e){_e().$$.on_destroy.push(e)}function Rt(){const e=_e();return(t,n,{cancelable:r=!1}={})=>{const l=e.$$.callbacks[t];if(l){const i=Kt(t,n,{cancelable:r});return l.slice().forEach(u=>{u.call(e,i)}),!i.defaultPrevented}return!0}}function jt(e,t){return _e().$$.context.set(e,t),t}function gt(e){return _e().$$.context.get(e)}function We(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(r=>r.call(this,t))}const ce=[],Be=[];let de=[];const Ge=[],It=Promise.resolve();let Fe=!1;function Ht(){Fe||(Fe=!0,It.then(ht))}function we(e){de.push(e)}const Pe=new Set;let oe=0;function ht(){if(oe!==0)return;const e=pe;do{try{for(;oe<ce.length;){const t=ce[oe];oe++,me(t),Jt(t.$$)}}catch(t){throw ce.length=0,oe=0,t}for(me(null),ce.length=0,oe=0;Be.length;)Be.pop()();for(let t=0;t<de.length;t+=1){const n=de[t];Pe.has(n)||(Pe.add(n),n())}de.length=0}while(ce.length);for(;Ge.length;)Ge.pop()();Fe=!1,Pe.clear(),me(e)}function Jt(e){if(e.fragment!==null){e.update(),re(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(we)}}function Wt(e){const t=[],n=[];de.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),de=t}const ye=new Set;let ue;function G(){ue={r:0,c:[],p:ue}}function Q(){ue.r||re(ue.c),ue=ue.p}function C(e,t){e&&e.i&&(ye.delete(e),e.i(t))}function D(e,t,n,r){if(e&&e.o){if(ye.has(e))return;ye.add(e),ue.c.push(()=>{ye.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function x(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function z(e){e&&e.c()}function N(e,t,n){const{fragment:r,after_update:l}=e.$$;r&&r.m(t,n),we(()=>{const i=e.$$.on_mount.map(ft).filter(Z);e.$$.on_destroy?e.$$.on_destroy.push(...i):re(i),e.$$.on_mount=[]}),l.forEach(we)}function M(e,t){const n=e.$$;n.fragment!==null&&(Wt(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Bt(e,t){e.$$.dirty[0]===-1&&(ce.push(e),Ht(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function W(e,t,n,r,l,i,u,a=[-1]){const o=pe;me(e);const s=e.$$={fragment:null,ctx:[],props:i,update:j,not_equal:l,bound:je(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:je(),dirty:a,skip_bound:!1,root:t.target||o.$$.root};u&&u(s.root);let f=!1;if(s.ctx=n?n(e,t.props||{},(g,d,...m)=>{const v=m.length?m[0]:d;return s.ctx&&l(s.ctx[g],s.ctx[g]=v)&&(!s.skip_bound&&s.bound[g]&&s.bound[g](v),f&&Bt(e,g)),d}):[],s.update(),f=!0,re(s.before_update),s.fragment=r?r(s.ctx):!1,t.target){if(t.hydrate){const g=zt(t.target);s.fragment&&s.fragment.l(g),g.forEach(K)}else s.fragment&&s.fragment.c();t.intro&&C(e.$$.fragment),N(e,t.target,t.anchor),ht()}me(o)}class B{constructor(){Ee(this,"$$");Ee(this,"$$set")}$destroy(){M(this,1),this.$destroy=j}$on(t,n){if(!Z(n))return j;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const l=r.indexOf(n);l!==-1&&r.splice(l,1)}}$set(t){this.$$set&&!Pt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Gt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Gt);const fe=[];function Le(e,t=j){let n;const r=new Set;function l(a){if(H(e,a)&&(e=a,n)){const o=!fe.length;for(const s of r)s[1](),fe.push(s,e);if(o){for(let s=0;s<fe.length;s+=2)fe[s][0](fe[s+1]);fe.length=0}}}function i(a){l(a(e))}function u(a,o=j){const s=[a,o];return r.add(s),r.size===1&&(n=t(l,i)||j),a(e),()=>{r.delete(s),r.size===0&&n&&(n(),n=null)}}return{set:l,update:i,subscribe:u}}const mt="settings",Qt={game:"pileon",colors:"default",size:"default"},Xt=JSON.parse(localStorage.getItem(mt)),ge=Le(Xt??Qt);ge.subscribe(e=>localStorage.setItem(mt,JSON.stringify(e)));const Yt={},ke=Le(Yt),Zt=4.5,$t=5,xt=3,Qe=7,en=5,pt=e=>{switch(e){case"bridge":return{height:Qe,width:Zt};case"poker":return{height:Qe,width:$t};case"small":return{height:en,width:xt}}},Ue="card-appearance",tn={size:"bridge",fourColor:!1},nn=({size:e,colors:t})=>({size:e==="default"?"poker":e,fourColor:t==="four-color"}),vt=e=>{const t=Le(tn,n=>(ge.subscribe(r=>n(e(r))),()=>{}));return jt(Ue,t),t},Ne=()=>gt(Ue),rn=e=>{const t=gt(Ue);if(t){const n=Ft(ge);t.set(e(n))}},Ce=(e,t,n={})=>r=>{(Array.isArray(e)?e:[e]).includes(r.code)&&t!==void 0&&(n.preventDefault&&r.preventDefault(),t())};var te={},be={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CardStringType=e.CardSuits=void 0;function t(s,f){if(!(s instanceof f))throw new TypeError("Cannot call a class as a function")}function n(s,f){for(var g=0;g<f.length;g++){var d=f[g];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(s,d.key,d)}}function r(s,f,g){return f&&n(s.prototype,f),g&&n(s,g),s}function l(s,f,g){return f in s?Object.defineProperty(s,f,{value:g,enumerable:!0,configurable:!0,writable:!0}):s[f]=g,s}var i;e.CardSuits=i,function(s){s[s.Hearts=0]="Hearts",s[s.Spades=1]="Spades",s[s.Diamonds=2]="Diamonds",s[s.Clubs=3]="Clubs"}(i||(e.CardSuits=i={}));var u;e.CardStringType=u,function(s){s.Short="SHORT",s.Long="LONG",s.ShortEmoji="SHORT_EMOJI",s.ShortSuit="SHORT_SUIT",s.LongSuit="LONG_SUIT",s.EmojiSuit="EMOJI_SUIT",s.ShortValue="SHORT_VALUE",s.LongValue="LONG_VALUE"}(u||(e.CardStringType=u={}));var a=function(){function s(f){t(this,s),l(this,"num",void 0),this.num=f}return r(s,[{key:"toString",value:function(){var g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.StringType.Long;switch(g){case s.StringType.Short:return this.toString(s.StringType.ShortValue)+this.toString(s.StringType.ShortSuit);case s.StringType.ShortEmoji:return this.toString(s.StringType.ShortValue)+this.toString(s.StringType.EmojiSuit);case s.StringType.Long:return this.toString(s.StringType.LongValue)+" of "+this.toString(s.StringType.LongSuit);case s.StringType.ShortSuit:return s.shortSuits[this.suit];case s.StringType.LongSuit:return s.longSuits[this.suit];case s.StringType.EmojiSuit:return s.emojiSuits[this.suit];case s.StringType.ShortValue:return s.shortValues[this.value===13?0:this.value];case s.StringType.LongValue:return s.longValues[this.value===13?0:this.value]}throw new Error("Unsupported output type")}},{key:"suit",get:function(){return s.getSuit(this.num)}},{key:"value",get:function(){return s.getValue(this.num)}}],[{key:"fromJSON",value:function(g){var d=g.num;return new s(d)}},{key:"getSuit",value:function(g){return Math.floor(g/13)%4}},{key:"getValue",value:function(g){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return g%13||d?g%13:13}},{key:"compare",value:function(g,d){return d.value-g.value}}]),s}();l(a,"Suits",i),l(a,"StringType",u),l(a,"emojiSuits",["♥","♠","♦","♣"]),l(a,"shortSuits",["h","s","d","c"]),l(a,"longSuits",["hearts","spades","diamonds","clubs"]),l(a,"shortValues",["A","2","3","4","5","6","7","8","9","T","J","Q","K"]),l(a,"longValues",["ace","two","three","four","five","six","seven","eight","nine","ten","jack","queen","king"]);var o=a;e.default=o})(be);var _t={},I={};Object.defineProperty(I,"__esModule",{value:!0});I.uniqueFilter=I.shuffle=I.last=I.isSorted=I.getCombinations=I.arraySubtraction=void 0;var ln=function(t,n){return t.filter(function(r){return!n.includes(r)})};I.arraySubtraction=ln;var un=function e(t,n,r,l,i){if(l.length>=n)i.push(l);else for(var u=r;u<t.length;u++)e(t,n,u+1,l.concat(t[u]),i)},sn=function(t,n){var r=[];return un(t,n,0,[],r),r};I.getCombinations=sn;var an=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=r?-1:1;try{return t.reduce(function(i,u){if(l*n(i,u)<=0)return u;throw new Error}),!0}catch{return!1}};I.isSorted=an;var on=function(t){return t[t.length-1]};I.last=on;var fn=function(t){for(var n=t.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),l=[t[r],t[n]];t[n]=l[0],t[r]=l[1]}return t};I.shuffle=fn;var cn=function(t,n,r){return r.indexOf(t)===n};I.uniqueFilter=cn;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(be),n=I;function r(v){return v&&v.__esModule?v:{default:v}}function l(v){return a(v)||u(v)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function u(v){if(Symbol.iterator in Object(v)||Object.prototype.toString.call(v)==="[object Arguments]")return Array.from(v)}function a(v){if(Array.isArray(v)){for(var y=0,O=new Array(v.length);y<v.length;y++)O[y]=v[y];return O}}function o(v,y){if(!(v instanceof y))throw new TypeError("Cannot call a class as a function")}function s(v,y){for(var O=0;O<y.length;O++){var c=y[O];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(v,c.key,c)}}function f(v,y,O){return y&&s(v.prototype,y),O&&s(v,O),v}function g(v,y,O){return y in v?Object.defineProperty(v,y,{value:O,enumerable:!0,configurable:!0,writable:!0}):v[y]=O,v}var d=function(){function v(){var y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;o(this,v),g(this,"cards",void 0),this.cards=l(Array(52*O).keys()).map(function(c){return new t.default(c)}),y&&this.shuffle()}return f(v,[{key:"shuffle",value:function(){(0,n.shuffle)(this.cards)}},{key:"isShuffled",value:function(){return!(0,n.isSorted)(this.cards,function(O,c){return O.num-c.num})}},{key:"pop",value:function(){return this.cards.pop()}},{key:"popN",value:function(O){for(var c=[],k,h=0;h<O&&(k=this.pop());h++)c.push(k);return c}},{key:"cardsRemaining",get:function(){return this.cards.length}}],[{key:"fromJSON",value:function(O){var c=O.cards,k=new v(!1,0);return k.cards=c.map(function(h){return t.default.fromJSON(h)}),k}}]),v}(),m=d;e.default=m})(_t);var bt={},Ae={};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.uuid4=void 0;var dn=function(t){var n;do n=Math.random().toString(16).slice(2,t+2);while(n.length<t&&t<=12);return n},gn=function(){var t=[8,4,4,4,12],n=t.map(dn).join("-").split("");return n[14]="4",n[19]=(Math.floor(Math.random()*64)%4+8).toString(16),n.join("")};Ae.uuid4=gn;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HandRank=void 0;var t=l(be),n=Ae,r=I;function l(c){return c&&c.__esModule?c:{default:c}}function i(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(h){return typeof h}:i=function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},i(c)}function u(c){return s(c)||o(c)||a()}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(c){if(Symbol.iterator in Object(c)||Object.prototype.toString.call(c)==="[object Arguments]")return Array.from(c)}function s(c){if(Array.isArray(c)){for(var k=0,h=new Array(c.length);k<c.length;k++)h[k]=c[k];return h}}function f(c,k){if(!(c instanceof k))throw new TypeError("Cannot call a class as a function")}function g(c,k){for(var h=0;h<k.length;h++){var S=k[h];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(c,S.key,S)}}function d(c,k,h){return k&&g(c.prototype,k),h&&g(c,h),c}function m(c,k,h){return k in c?Object.defineProperty(c,k,{value:h,enumerable:!0,configurable:!0,writable:!0}):c[k]=h,c}var v;e.HandRank=v,function(c){c[c.High=0]="High",c[c.Pair=5]="Pair",c[c.TwoPairs=10]="TwoPairs",c[c.ThreeOfAKind=15]="ThreeOfAKind",c[c.Straight=20]="Straight",c[c.Flush=25]="Flush",c[c.FullHouse=30]="FullHouse",c[c.FourOfAKind=35]="FourOfAKind",c[c.StraightFlush=40]="StraightFlush",c[c.FiveOfAKind=45]="FiveOfAKind"}(v||(e.HandRank=v={}));var y=function(){function c(k,h,S){f(this,c),m(this,"uuid",void 0),m(this,"rank",void 0),m(this,"cards",void 0),this.rank=k,this.cards=h,this.uuid=S||(0,n.uuid4)()}return d(c,[{key:"getCardsString",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.default.StringType.Short;return this.cards.map(function(S){return S.toString(h)}).join(", ")}},{key:"toString",value:function(){var h=this,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.default.StringType.Short,_=t.default.StringType.LongValue,b=function(E){return h.cards[E].toString(_)},p=this.getCardsString(S);switch(this.rank){case c.Rank.FiveOfAKind:return"Five of a kind, ".concat(b(0),"s (").concat(p,")");case c.Rank.StraightFlush:return"Straigth flush, ".concat(b(0)," high (").concat(p,")");case c.Rank.FourOfAKind:return"Four of a kind, ".concat(b(0),"s (").concat(p,")");case c.Rank.FullHouse:return"Full house, ".concat(b(0),"s over ").concat(b(3),"s (").concat(p,")");case c.Rank.Flush:return"Flush, ".concat(b(0)," high (").concat(p,")");case c.Rank.Straight:return"Straigth, ".concat(b(0)," high (").concat(p,")");case c.Rank.ThreeOfAKind:return"Three of a kind, ".concat(b(0),"s (").concat(p,")");case c.Rank.TwoPairs:return"Two pairs, ".concat(b(0),"s and ").concat(b(2),"s (").concat(p,")");case c.Rank.Pair:return"Pair, ".concat(b(0),"s (").concat(p,")");case c.Rank.High:return"".concat(b(0).replace(/^\w/,function(T){return T.toUpperCase()})," high (").concat(p,")")}throw new Error("Unsupported rank value")}}],[{key:"fromJSON",value:function(h){var S=h.rank,_=h.cards,b=h.uuid;return new c(S,_.map(t.default.fromJSON),b)}},{key:"solve",value:function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_,b;return(_=c.isNumOfAKind(5,h))?b=c.Rank.FiveOfAKind:(_=c.isStraightFlush(h,S))?b=c.Rank.StraightFlush:(_=c.isNumOfAKind(4,h))?b=c.Rank.FourOfAKind:(_=c.isFullHouse(h))?b=c.Rank.FullHouse:(_=c.isFlush(h,S))?b=c.Rank.Flush:(_=c.isStraight(h,S))?b=c.Rank.Straight:(_=c.isNumOfAKind(3,h))?b=c.Rank.ThreeOfAKind:(_=c.isTwoPairs(h))?b=c.Rank.TwoPairs:(_=c.isNumOfAKind(2,h))?b=c.Rank.Pair:(_=[],b=c.Rank.High),_=c.fillWithKickers(_,h),new c(b,_)}},{key:"solveHoldEm",value:function(h,S){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(_===0)return c.solve([].concat(u(h),u(S)));for(var b=(0,r.getCombinations)(h,h.length-_),p=(0,r.getCombinations)(S,Math.min(S.length,_)),T=[],E=0;E<b.length;E++)for(var U=0;U<p.length;U++)T.push(c.solve([].concat(u(b[E]),u(p[U]))));return c.max.apply(c,T)}},{key:"compare",value:function(h,S){var _;if(h.cards.length!==S.cards.length)throw new Error("Comparing hands with different number of cards");if((_=S.rank-h.rank)!==0)return _;for(var b=0;b<h.cards.length;b++)if((_=t.default.compare(h.cards[b],S.cards[b]))!==0)return _;return 0}},{key:"winners",value:function(){for(var h=arguments.length,S=new Array(h),_=0;_<h;_++)S[_]=arguments[_];var b=c.max.apply(c,S);return S.filter(function(p){return!c.compare(p,b)})}},{key:"max",value:function(){for(var h=function(T,E){return c.compare(T,E)<0?T:E},S=arguments.length,_=new Array(S),b=0;b<S;b++)_[b]=arguments[b];return _.reduce(function(p,T){return h(p,T)})}},{key:"fillWithKickers",value:function(h,S){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;return S=(0,r.arraySubtraction)(S,h).sort(t.default.compare),[].concat(u(h),u(S)).slice(0,_)}},{key:"getUniqueValues",value:function(h){return h.map(function(S){return S.value}).filter(r.uniqueFilter).sort(function(S,_){return _-S})}},{key:"isNumOfAKind",value:function(h,S){for(var _=c.getUniqueValues(S),b,p=function(X){if(b=S.filter(function($){return $.value==_[X]}),b.length>=h)return{v:b}},T=0;T<_.length;T++){var E=p(T);if(i(E)==="object")return E.v}return!1}},{key:"isNumOfAKindCombination",value:function(h,S){for(var _=[],b=0;b<h.length;b++){var p=c.isNumOfAKind(h[b],(0,r.arraySubtraction)(S,_));if(p===!1)return!1;p=p,_.push.apply(_,u(p))}return _}},{key:"isStraightFlush",value:function(h){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_=[],b=function(U){if(_=h.filter(function($){return $.suit===U}),_.length<S)return"continue";var X=c.isStraight(_,S);if(X)return{v:X}},p=0;p<4;p++){var T=b(p);switch(T){case"continue":continue;default:if(i(T)==="object")return T.v}}return!1}},{key:"isFullHouse",value:function(h){return c.isNumOfAKindCombination([3,2],h)}},{key:"isFlush",value:function(h){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_=function(E){var U=h.filter(function(X){return X.suit==E});if(U.length>=S)return{v:U.sort(t.default.compare).slice(0,S)}},b=0;b<4;b++){var p=_(b);if(i(p)==="object")return p.v}return!1}},{key:"isStraight",value:function(h){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_=c.getUniqueValues(h);if(_.length<S)return!1;_.includes(13)&&_.push(0);for(var b=[_[0]],p=1;p<_.length&&b.length<S;p++)(0,r.last)(b)-_[p]===1?b.push(_[p]):b=[_[p]];return b.length==S?b.map(function(T){return h.find(function(E){return E.value===(T||13)})}):!1}},{key:"isTwoPairs",value:function(h){return c.isNumOfAKindCombination([2,2],h)}}]),c}();m(y,"Rank",v);var O=y;e.default=O})(bt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Card",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"Deck",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"Hand",{enumerable:!0,get:function(){return r.default}});var t=l(be),n=l(_t),r=l(bt);function l(i){return i&&i.__esModule?i:{default:i}}})(te);function hn(e){let t,n;return{c(){t=Se("svg"),n=Se("path"),w(n,"d",e[1]),w(n,"fill","CurrentColor"),w(t,"viewBox","0 0 16 20"),w(t,"class","svelte-1jimf84"),F(t,"flip",e[0])},m(r,l){q(r,t,l),A(t,n)},p(r,[l]){l&2&&w(n,"d",r[1]),l&1&&F(t,"flip",r[0])},i:j,o:j,d(r){r&&K(t)}}}function mn(e,t,n){let r,{suit:l=null}=t,{flip:i=!1}=t;const u=a=>{switch(a){case"hearts":return"M 8 2 C 9 0 11 0 12 0 C 13 0 16 1 16 6 C 16 8 15.5 10 14 12 L 8 20 L 2 12 C 0.5 10 0 8 0 6 C 0 1 3 0 4 0 C 5 0 7 0 8 2";case"spades":return"M 8 0 L 13 5 C 16 8 16 10 16 12 C 16 14 14 16 12 16 C 11 16 9 16 8 14 L 12 20 L 4 20 L 8 14 C 7 16 5 16 4 16 C 2 16 0 14 0 12 C 0 10 0 8 3 5 L 8 0";case"diamonds":return"M 8 0 L 16 10 L 8 20 L 0 10 L 8 0";case"clubs":return"M 8 0 C 10 0 12 2 12 4 C 12 6 11 8 8 10 C 9 8 10 7 12 7 C 14 7 16 9 16 12 C 16 14 14 16 12 16 C 11 16 9 16 8 14 L 12 20 L 4 20 L 8 14 C 7 16 5 16 4 16 C 2 16 0 14 0 12 C 0 9 2 7 4 7 C 6 7 7 8 8 10 C 5 8 4 6 4 4 C 4 2 6 0 8 0";default:return null}};return e.$$set=a=>{"suit"in a&&n(2,l=a.suit),"flip"in a&&n(0,i=a.flip)},e.$$.update=()=>{e.$$.dirty&4&&n(1,r=u(l))},[i,r,l]}class yt extends B{constructor(t){super(),W(this,t,mn,hn,H,{suit:2,flip:0})}}function Xe(e,t,n){const r=e.slice();return r[5]=t[n],r}function Ye(e,t,n){const r=e.slice();return r[8]=t[n],r}function Ze(e){let t,n,r;return n=new yt({props:{suit:e[0],flip:e[8].toLowerCase()==="d"}}),{c(){t=P("span"),z(n.$$.fragment),w(t,"class","svelte-1sm49dl")},m(l,i){q(l,t,i),N(n,t,null),r=!0},p(l,i){const u={};i&1&&(u.suit=l[0]),i&2&&(u.flip=l[8].toLowerCase()==="d"),n.$set(u)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){D(n.$$.fragment,l),r=!1},d(l){l&&K(t),M(n)}}}function $e(e){let t,n,r,l,i=x(e[5].split("")),u=[];for(let o=0;o<i.length;o+=1)u[o]=Ze(Ye(e,i,o));const a=o=>D(u[o],1,1,()=>{u[o]=null});return{c(){t=P("div");for(let o=0;o<u.length;o+=1)u[o].c();n=V(),w(t,"class",r="row "+e[3](e[5])+" svelte-1sm49dl")},m(o,s){q(o,t,s);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(t,null);A(t,n),l=!0},p(o,s){if(s&7){i=x(o[5].split(""));let f;for(f=0;f<i.length;f+=1){const g=Ye(o,i,f);u[f]?(u[f].p(g,s),C(u[f],1)):(u[f]=Ze(g),u[f].c(),C(u[f],1),u[f].m(t,n))}for(G(),f=i.length;f<u.length;f+=1)a(f);Q()}(!l||s&2&&r!==(r="row "+o[3](o[5])+" svelte-1sm49dl"))&&w(t,"class",r)},i(o){if(!l){for(let s=0;s<i.length;s+=1)C(u[s]);l=!0}},o(o){u=u.filter(Boolean);for(let s=0;s<u.length;s+=1)D(u[s]);l=!1},d(o){o&&K(t),ve(u,o)}}}function pn(e){let t,n,r=x(e[2](e[1])),l=[];for(let u=0;u<r.length;u+=1)l[u]=$e(Xe(e,r,u));const i=u=>D(l[u],1,1,()=>{l[u]=null});return{c(){t=P("div");for(let u=0;u<l.length;u+=1)l[u].c();w(t,"class","center-pattern svelte-1sm49dl")},m(u,a){q(u,t,a);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(t,null);n=!0},p(u,[a]){if(a&15){r=x(u[2](u[1]));let o;for(o=0;o<r.length;o+=1){const s=Xe(u,r,o);l[o]?(l[o].p(s,a),C(l[o],1)):(l[o]=$e(s),l[o].c(),C(l[o],1),l[o].m(t,null))}for(G(),o=r.length;o<l.length;o+=1)i(o);Q()}},i(u){if(!n){for(let a=0;a<r.length;a+=1)C(l[a]);n=!0}},o(u){l=l.filter(Boolean);for(let a=0;a<l.length;a+=1)D(l[a]);n=!1},d(u){u&&K(t),ve(l,u)}}}function vn(e,t,n){let{suit:r}=t,{rank:l}=t;const i={A:["U"],2:["U","D"],3:["U","U","D"],4:["UU","DD"],5:["UU","U","DD"],6:["UU","UU","DD"],7:["UU","u","UU","DD"],8:["UU","UU","DD","DD"],9:["UU","u","UU","DD","DD"],10:["UU","u","UU","DD","d","DD"]},u=o=>i[o]??[],a=o=>o.toUpperCase()===o?"grow":"";return e.$$set=o=>{"suit"in o&&n(0,r=o.suit),"rank"in o&&n(1,l=o.rank)},[r,l,u,a]}class _n extends B{constructor(t){super(),W(this,t,vn,pn,H,{suit:0,rank:1})}}function bn(e){let t,n;const r=e[1].default,l=Lt(r,e,e[0],null);return{c(){t=P("span"),l&&l.c(),w(t,"class","screen-reader-only svelte-3uotpv")},m(i,u){q(i,t,u),l&&l.m(t,null),n=!0},p(i,[u]){l&&l.p&&(!n||u&1)&&Nt(l,r,i,i[0],n?Ut(r,i[0],u,null):Mt(i[0]),null)},i(i){n||(C(l,i),n=!0)},o(i){D(l,i),n=!1},d(i){i&&K(t),l&&l.d(i)}}}function yn(e,t,n){let{$$slots:r={},$$scope:l}=t;return e.$$set=i=>{"$$scope"in i&&n(0,l=i.$$scope)},[l,r]}class Sn extends B{constructor(t){super(),W(this,t,yn,bn,H,{})}}function xe(e,t,n){const r=e.slice();return r[16]=t[n],r}function et(e){let t,n;return t=new Sn({props:{$$slots:{default:[wn]},$$scope:{ctx:e}}}),{c(){z(t.$$.fragment)},m(r,l){N(t,r,l),n=!0},p(r,l){const i={};l&524320&&(i.$$scope={dirty:l,ctx:r}),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){M(t,r)}}}function wn(e){let t;return{c(){t=Y(e[5])},m(n,r){q(n,t,r)},p(n,r){r&32&&De(t,n[5])},d(n){n&&K(t)}}}function tt(e){let t,n;return t=new _n({props:{suit:e[7],rank:e[8]}}),{c(){z(t.$$.fragment)},m(r,l){N(t,r,l),n=!0},p(r,l){const i={};l&128&&(i.suit=r[7]),l&256&&(i.rank=r[8]),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){M(t,r)}}}function nt(e){let t,n,r,l,i,u,a,o,s,f,g;a=new yt({props:{suit:e[7]}});let d=!e[10]&&tt(e);return{c(){t=P("div"),n=P("div"),r=Y(e[8]),i=V(),u=P("div"),z(a.$$.fragment),o=V(),s=P("div"),d&&d.c(),f=V(),w(n,"class",l="rank rank-"+e[8]+" svelte-t2vtqs"),w(u,"class","suit svelte-t2vtqs"),w(t,"aria-hidden","true"),w(t,"class",e[16]+" label svelte-t2vtqs"),w(s,"class","center svelte-t2vtqs"),F(s,"face",e[6])},m(m,v){q(m,t,v),A(t,n),A(n,r),A(t,i),A(t,u),N(a,u,null),q(m,o,v),q(m,s,v),d&&d.m(s,null),A(s,f),g=!0},p(m,v){(!g||v&256)&&De(r,m[8]),(!g||v&256&&l!==(l="rank rank-"+m[8]+" svelte-t2vtqs"))&&w(n,"class",l);const y={};v&128&&(y.suit=m[7]),a.$set(y),m[10]?d&&(G(),D(d,1,1,()=>{d=null}),Q()):d?(d.p(m,v),v&1024&&C(d,1)):(d=tt(m),d.c(),C(d,1),d.m(s,f)),(!g||v&64)&&F(s,"face",m[6])},i(m){g||(C(a.$$.fragment,m),C(d),g=!0)},o(m){D(a.$$.fragment,m),D(d),g=!1},d(m){m&&(K(t),K(o),K(s)),M(a),d&&d.d()}}}function kn(e){let t,n,r,l,i=e[3]&&et(e),u=x(e[13]),a=[];for(let s=0;s<u.length;s+=1)a[s]=nt(xe(e,u,s));const o=s=>D(a[s],1,1,()=>{a[s]=null});return{c(){t=P("div"),i&&i.c(),n=V();for(let s=0;s<a.length;s+=1)a[s].c();w(t,"class",r="card "+e[7]+" stack-"+e[2]+" svelte-t2vtqs"),F(t,"bridge",e[11]),F(t,"small",e[10]),F(t,"fourColor",e[9]),F(t,"empty",e[0]),F(t,"hidden",e[4]),F(t,"shadow",e[1]),F(t,"visible",e[3])},m(s,f){q(s,t,f),i&&i.m(t,null),A(t,n);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(t,null);l=!0},p(s,[f]){if(s[3]?i?(i.p(s,f),f&8&&C(i,1)):(i=et(s),i.c(),C(i,1),i.m(t,n)):i&&(G(),D(i,1,1,()=>{i=null}),Q()),f&9664){u=x(s[13]);let g;for(g=0;g<u.length;g+=1){const d=xe(s,u,g);a[g]?(a[g].p(d,f),C(a[g],1)):(a[g]=nt(d),a[g].c(),C(a[g],1),a[g].m(t,null))}for(G(),g=u.length;g<a.length;g+=1)o(g);Q()}(!l||f&132&&r!==(r="card "+s[7]+" stack-"+s[2]+" svelte-t2vtqs"))&&w(t,"class",r),(!l||f&2180)&&F(t,"bridge",s[11]),(!l||f&1156)&&F(t,"small",s[10]),(!l||f&644)&&F(t,"fourColor",s[9]),(!l||f&133)&&F(t,"empty",s[0]),(!l||f&148)&&F(t,"hidden",s[4]),(!l||f&134)&&F(t,"shadow",s[1]),(!l||f&140)&&F(t,"visible",s[3])},i(s){if(!l){C(i);for(let f=0;f<u.length;f+=1)C(a[f]);l=!0}},o(s){D(i),a=a.filter(Boolean);for(let f=0;f<a.length;f+=1)D(a[f]);l=!1},d(s){s&&K(t),i&&i.d(),ve(a,s)}}}function Cn(e,t,n){let r,l,i,u,a,o,s,f,g,d;const m=Ne();ne(e,m,h=>n(15,d=h));let{card:v=null}=t,{empty:y=!1}=t,{shadow:O=!1}=t,{stack:c=void 0}=t;const k=["top","bottom"];return e.$$set=h=>{"card"in h&&n(14,v=h.card),"empty"in h&&n(0,y=h.empty),"shadow"in h&&n(1,O=h.shadow),"stack"in h&&n(2,c=h.stack)},e.$$.update=()=>{e.$$.dirty&32768&&n(11,r=d.size==="bridge"),e.$$.dirty&32768&&n(10,l=d.size==="small"),e.$$.dirty&32768&&n(9,i=d.fourColor),e.$$.dirty&16386&&n(4,u=v===null&&!O),e.$$.dirty&19&&n(3,a=!(y||u||O)),e.$$.dirty&16392&&n(8,o=a&&v.toString(te.Card.StringType.ShortValue).replace("T","10")),e.$$.dirty&16392&&n(7,s=a&&v.toString(te.Card.StringType.LongSuit)),e.$$.dirty&16392&&n(6,f=a&&v.num%13>9),e.$$.dirty&16392&&n(5,g=a&&v.toString(te.Card.StringType.Long))},[y,O,c,a,u,g,f,s,o,i,l,r,m,k,v,d]}class Oe extends B{constructor(t){super(),W(this,t,Cn,kn,H,{card:14,empty:0,shadow:1,stack:2})}}function rt(e,t,n){const r=e.slice();return r[18]=t[n].card,r[19]=t[n].shadow,r[20]=t[n].transform,r}function lt(e){let t,n;return t=new Oe({props:{card:e[0],empty:e[0]===void 0}}),{c(){z(t.$$.fragment)},m(r,l){N(t,r,l),n=!0},p(r,l){const i={};l&1&&(i.card=r[0]),l&1&&(i.empty=r[0]===void 0),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){M(t,r)}}}function it(e){let t,n,r,l;return n=new Oe({props:{card:e[18],shadow:e[19]}}),{c(){t=P("div"),z(n.$$.fragment),r=V(),w(t,"class","shadow-container svelte-1ns87h6"),He(t,"transform",e[20])},m(i,u){q(i,t,u),N(n,t,null),A(t,r),l=!0},p(i,u){const a={};u&16&&(a.card=i[18]),u&16&&(a.shadow=i[19]),n.$set(a),(!l||u&16)&&He(t,"transform",i[20])},i(i){l||(C(n.$$.fragment,i),l=!0)},o(i){D(n.$$.fragment,i),l=!1},d(i){i&&K(t),M(n)}}}function Dn(e){let t,n,r,l,i,u,a=!e[2]&&lt(e),o=x(e[4]),s=[];for(let g=0;g<o.length;g+=1)s[g]=it(rt(e,o,g));const f=g=>D(s[g],1,1,()=>{s[g]=null});return{c(){t=P("div"),n=P("div"),a&&a.c(),r=V();for(let g=0;g<s.length;g+=1)s[g].c();w(n,"aria-atomic","true"),w(n,"aria-live","polite"),w(t,"aria-label",e[3]),w(t,"class","deck svelte-1ns87h6"),w(t,"role","button"),w(t,"tabindex","0"),F(t,"bridge",e[6]),F(t,"small",e[5]),F(t,"shuffling",e[2])},m(g,d){q(g,t,d),A(t,n),a&&a.m(n,null),A(n,r);for(let m=0;m<s.length;m+=1)s[m]&&s[m].m(n,null);l=!0,i||(u=[J(t,"keydown",function(){Z(Ce(["Space","Enter"],e[1],{preventDefault:!0}))&&Ce(["Space","Enter"],e[1],{preventDefault:!0}).apply(this,arguments)}),J(t,"click",function(){Z(e[1])&&e[1].apply(this,arguments)})],i=!0)},p(g,[d]){if(e=g,e[2]?a&&(G(),D(a,1,1,()=>{a=null}),Q()):a?(a.p(e,d),d&4&&C(a,1)):(a=lt(e),a.c(),C(a,1),a.m(n,r)),d&16){o=x(e[4]);let m;for(m=0;m<o.length;m+=1){const v=rt(e,o,m);s[m]?(s[m].p(v,d),C(s[m],1)):(s[m]=it(v),s[m].c(),C(s[m],1),s[m].m(n,null))}for(G(),m=o.length;m<s.length;m+=1)f(m);Q()}(!l||d&8)&&w(t,"aria-label",e[3]),(!l||d&64)&&F(t,"bridge",e[6]),(!l||d&32)&&F(t,"small",e[5]),(!l||d&4)&&F(t,"shuffling",e[2])},i(g){if(!l){C(a);for(let d=0;d<o.length;d+=1)C(s[d]);l=!0}},o(g){D(a),s=s.filter(Boolean);for(let d=0;d<s.length;d+=1)D(s[d]);l=!1},d(g){g&&K(t),a&&a.d(),ve(s,g),i=!1,re(u)}}}function An(e,t,n,r){const l=e/r*t,i=.5*l/(n*52),u=1*l/(n*52);return`translate(${i}em , ${u}em)`}function On(e,t,n){let r,l,i,u,a,o;const s=Ne();ne(e,s,_=>n(15,o=_));let{numCards:f=52}=t,{numDecks:g=1}=t,{topCard:d=null}=t,{numShadows:m=10}=t,{shuffleAnimationSteps:v=4}=t,{shuffleAnimationMaxDistanceEm:y=.8}=t,{shuffleAnimationMaxRotateDeg:O=7}=t,{onClick:c=()=>{}}=t,k=0;function h(_,b){const p=X=>[1,b+2].includes(_)?0:(Math.random()*2-1)*X,T=p(y),E=p(y),U=p(O);return`translate(${T}em, ${E}em) rotate(${U}deg)`}function S(){k>0&&setTimeout(()=>{n(14,k-=1),S()},250)}return e.$$set=_=>{"numCards"in _&&n(8,f=_.numCards),"numDecks"in _&&n(9,g=_.numDecks),"topCard"in _&&n(0,d=_.topCard),"numShadows"in _&&n(10,m=_.numShadows),"shuffleAnimationSteps"in _&&n(11,v=_.shuffleAnimationSteps),"shuffleAnimationMaxDistanceEm"in _&&n(12,y=_.shuffleAnimationMaxDistanceEm),"shuffleAnimationMaxRotateDeg"in _&&n(13,O=_.shuffleAnimationMaxRotateDeg),"onClick"in _&&n(1,c=_.onClick)},e.$$.update=()=>{e.$$.dirty&32768&&n(6,r=(o==null?void 0:o.size)==="bridge"),e.$$.dirty&32768&&n(5,l=(o==null?void 0:o.size)==="small"),e.$$.dirty&2817&&d===null&&f===52*g&&v>0&&(n(14,k=v+2),S()),e.$$.dirty&16384&&n(2,u=k>0),e.$$.dirty&20229&&n(4,i=d===void 0?[]:u?[...Array(m)].map((_,b)=>({card:null,shadow:!1,transform:h(k,v)})):[...Array(m)].map((_,b)=>({card:void 0,shadow:!0,transform:An(b,f,g,m)}))),e.$$.dirty&1&&n(3,a=d===void 0?"Shuffle the deck":"Draw a card")},[d,c,u,a,i,l,r,s,f,g,m,v,y,O,k,o]}class Tn extends B{constructor(t){super(),W(this,t,On,Dn,H,{numCards:8,numDecks:9,topCard:0,numShadows:10,shuffleAnimationSteps:11,shuffleAnimationMaxDistanceEm:12,shuffleAnimationMaxRotateDeg:13,onClick:1})}}function En(e){let t,n,r;return n=new Tn({props:{onClick:e[2],topCard:e[1],numCards:e[0]}}),{c(){t=P("main"),z(n.$$.fragment),w(t,"class","svelte-1tag1lj")},m(l,i){q(l,t,i),N(n,t,null),r=!0},p(l,[i]){const u={};i&2&&(u.topCard=l[1]),i&1&&(u.numCards=l[0]),n.$set(u)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){D(n.$$.fragment,l),r=!1},d(l){l&&K(t),M(n)}}}function Pn(e,t,n){vt(nn);let r=new te.Deck,l=r.cardsRemaining,i=null;function u(){i!==void 0?n(1,i=r.pop()):(r=new te.Deck,n(1,i=null)),n(0,l=r.cardsRemaining)}return[l,i,u]}class Fn extends B{constructor(t){super(),W(this,t,Pn,En,H,{})}}const St=(e,t)=>pt(t).width+(e-1)*1.125,Ln=(e,t,n)=>{const r={sourceStack:t,cards:n};e.dataTransfer.setData("application/json",JSON.stringify(r)),e.dataTransfer.effectAllowed="move"},Un=e=>{const{sourceStack:t,cards:n}=JSON.parse(e.dataTransfer.getData("application/json"));return{sourceStack:t,cards:n.map(te.Card.fromJSON)}};function Nn(e){let t,n;return t=new Oe({props:{card:e[10]?null:e[0][0],stack:"left"}}),{c(){z(t.$$.fragment)},m(r,l){N(t,r,l),n=!0},p(r,l){const i={};l&1025&&(i.card=r[10]?null:r[0][0]),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){M(t,r)}}}function Mn(e){let t,n;return t=new Oe({props:{empty:!0}}),{c(){z(t.$$.fragment)},m(r,l){N(t,r,l),n=!0},p:j,i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){M(t,r)}}}function ut(e){let t,n,r;return n=new wt({props:{cards:e[0].slice(1),capacity:e[1]-1,nested:!0,closed:e[2],index:e[3],isDraggableFn:e[4],selectedCardsN:e[5]}}),{c(){t=P("div"),z(n.$$.fragment),w(t,"class","nested svelte-o50ay1")},m(l,i){q(l,t,i),N(n,t,null),r=!0},p(l,i){const u={};i&1&&(u.cards=l[0].slice(1)),i&2&&(u.capacity=l[1]-1),i&4&&(u.closed=l[2]),i&8&&(u.index=l[3]),i&16&&(u.isDraggableFn=l[4]),i&32&&(u.selectedCardsN=l[5]),n.$set(u)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){D(n.$$.fragment,l),r=!1},d(l){l&&K(t),M(n)}}}function zn(e){let t,n,r,l,i,u,a,o;const s=[Mn,Nn],f=[];function g(m,v){return m[0].length===0?0:1}n=g(e),r=f[n]=s[n](e);let d=e[0].length>1&&ut(e);return{c(){t=P("div"),r.c(),l=V(),d&&d.c(),w(t,"class","stack svelte-o50ay1"),w(t,"style",e[13]),w(t,"draggable",e[12]),w(t,"tabindex",i=e[6]?void 0:0),F(t,"selected",e[11])},m(m,v){q(m,t,v),f[n].m(t,null),A(t,l),d&&d.m(t,null),u=!0,a||(o=[J(t,"dblclick",e[17]),J(t,"dragstart",function(){Z(e[9])&&e[9].apply(this,arguments)}),J(t,"dragover",function(){Z(e[8])&&e[8].apply(this,arguments)}),J(t,"drop",e[18]),J(t,"click",function(){Z(e[7])&&e[7].apply(this,arguments)}),J(t,"keydown",function(){Z(Ce(["Enter","Space"],e[7],{preventDefault:!0}))&&Ce(["Enter","Space"],e[7],{preventDefault:!0}).apply(this,arguments)})],a=!0)},p(m,[v]){e=m;let y=n;n=g(e),n===y?f[n].p(e,v):(G(),D(f[y],1,1,()=>{f[y]=null}),Q(),r=f[n],r?r.p(e,v):(r=f[n]=s[n](e),r.c()),C(r,1),r.m(t,l)),e[0].length>1?d?(d.p(e,v),v&1&&C(d,1)):(d=ut(e),d.c(),C(d,1),d.m(t,null)):d&&(G(),D(d,1,1,()=>{d=null}),Q()),(!u||v&8192)&&w(t,"style",e[13]),(!u||v&4096)&&w(t,"draggable",e[12]),(!u||v&64&&i!==(i=e[6]?void 0:0))&&w(t,"tabindex",i),(!u||v&2048)&&F(t,"selected",e[11])},i(m){u||(C(r),C(d),u=!0)},o(m){D(r),D(d),u=!1},d(m){m&&K(t),f[n].d(),d&&d.d(),a=!1,re(o)}}}function Kn(e,t,n){let r,l,i,u,a,o,s,f,g;const d=Ne();ne(e,d,p=>n(16,g=p));let{cards:m=[]}=t,{capacity:v=4}=t,{closed:y=!1}=t,{index:O=0}=t,{isDraggableFn:c=()=>!1}=t,{selectedCardsN:k=0}=t,{nested:h=!1}=t;const S=Rt();function _(p){We.call(this,e,p)}function b(p){We.call(this,e,p)}return e.$$set=p=>{"cards"in p&&n(0,m=p.cards),"capacity"in p&&n(1,v=p.capacity),"closed"in p&&n(2,y=p.closed),"index"in p&&n(3,O=p.index),"isDraggableFn"in p&&n(4,c=p.isDraggableFn),"selectedCardsN"in p&&n(5,k=p.selectedCardsN),"nested"in p&&n(6,h=p.nested)},e.$$.update=()=>{e.$$.dirty&65536&&n(15,r=g.size),e.$$.dirty&32770&&n(13,l=`width: ${St(v,r)}em`),e.$$.dirty&21&&n(12,i=!y&&c(m)),e.$$.dirty&33&&n(11,u=k>0&&k===m.length),e.$$.dirty&5&&n(10,a=y&&m.length===1),e.$$.dirty&9&&n(9,o=p=>{p.stopPropagation(),Ln(p,O,m)}),e.$$.dirty&72&&n(7,f=()=>{h||S("select",{index:O})})},n(8,s=p=>{p.preventDefault()}),[m,v,y,O,c,k,h,f,s,o,a,u,i,l,d,r,g,_,b]}class wt extends B{constructor(t){super(),W(this,t,Kn,zn,H,{cards:0,capacity:1,closed:2,index:3,isDraggableFn:4,selectedCardsN:5,nested:6})}}const qn=e=>St(4,e)*5+(e!=="small"?.666:.333)*10,Vn=e=>pt(e).height*3+(e!=="small"?.5:.25)*6,Rn=()=>{const e=new te.Deck;return[...Array(13)].map(()=>e.popN(4)).concat([[],[]])},Me=e=>{const[t,...n]=e;return n.every(r=>r.value===t.value)},jn=e=>e.length===0?!1:e.length===1?!0:Me(e),kt=(e,t)=>e.length+t.length>4?!1:t.length===0||t[t.length-1].value===e[0].value,Ct=(e,t,n,r)=>{const l=e.map(i=>[...i]);if(!kt(r,l[n]))throw new Error(`Can not move cards ${r.map(i=>i.toString(be.CardStringType.ShortEmoji))} from pile ${t} to pile ${n}`);return l[t]=l[t].slice(0,l[t].length-r.length),l[n]=[...l[n],...r],l},ze=e=>e.length===1||Me(e)?e:ze(e.slice(1)),In=(e,t)=>{if(e[t].length===0)throw new Error("Cannot move cards from an empty pile.");if(Dt(e[t]))throw new Error("Cannot move cards from a completed pile.");const n=ze(e[t]),r=e.reduce((u,a,o)=>o!==t&&kt(n,a)?[...u,o]:u,[]);if(r.length===0)throw new Error(`Cannot move cards from pile ${t} to any other pile`);const l=r.filter(u=>e[u].length>0),i=l.length>0?l[0]:r[0];return Ct(e,t,i,n)},Dt=e=>e.length===4&&Me(e),Hn=e=>e.reduce((t,n,r)=>Dt(n)?[...t,r]:t,[]);function st(e,t,n){const r=e.slice();return r[20]=t[n],r[22]=n,r}function at(e){let t,n,r,l;return n=new wt({props:{cards:e[20],closed:e[7].includes(e[22]),selectedCardsN:e[6]===e[22]?e[5].length:0,index:e[22],isDraggableFn:jn}}),n.$on("drop",e[10](e[22])),n.$on("dblclick",e[11](e[22])),n.$on("select",e[9]),{c(){t=P("div"),z(n.$$.fragment),r=V(),w(t,"class","pile svelte-1nmr9wh"),F(t,"small",e[2]==="small")},m(i,u){q(i,t,u),N(n,t,null),A(t,r),l=!0},p(i,u){const a={};u&8&&(a.cards=i[20]),u&128&&(a.closed=i[7].includes(i[22])),u&96&&(a.selectedCardsN=i[6]===i[22]?i[5].length:0),n.$set(a),(!l||u&4)&&F(t,"small",i[2]==="small")},i(i){l||(C(n.$$.fragment,i),l=!0)},o(i){D(n.$$.fragment,i),l=!1},d(i){i&&K(t),M(n)}}}function Jn(e){let t,n,r,l;we(e[17]);let i=x(e[3]),u=[];for(let o=0;o<i.length;o+=1)u[o]=at(st(e,i,o));const a=o=>D(u[o],1,1,()=>{u[o]=null});return{c(){t=P("main");for(let o=0;o<u.length;o+=1)u[o].c();w(t,"class","pileon svelte-1nmr9wh"),w(t,"style",e[4])},m(o,s){q(o,t,s);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(t,null);n=!0,r||(l=J(window,"resize",e[17]),r=!0)},p(o,[s]){if(s&3820){i=x(o[3]);let f;for(f=0;f<i.length;f+=1){const g=st(o,i,f);u[f]?(u[f].p(g,s),C(u[f],1)):(u[f]=at(g),u[f].c(),C(u[f],1),u[f].m(t,null))}for(G(),f=i.length;f<u.length;f+=1)a(f);Q()}(!n||s&16)&&w(t,"style",o[4])},i(o){if(!n){for(let s=0;s<i.length;s+=1)C(u[s]);n=!0}},o(o){u=u.filter(Boolean);for(let s=0;s<u.length;s+=1)D(u[s]);n=!1},d(o){o&&K(t),ve(u,o),r=!1,l()}}}function Wn(e,t,n){let r,l,i,u,a,o,s,f,g,d,m,v=vt(p=>({size:p.size==="default"?"bridge":p.size,fourColor:p.colors==="four-color"}));ne(e,v,p=>n(16,g=p));let y=[Rn()];const O=p=>{p.stopPropagation(),y.length>1&&n(12,y=y.slice(0,y.length-1))};let c=[void 0,[]];const k=(p,T,E)=>{try{n(13,c=[void 0,[]]);const U=Ct(y[y.length-1],p,T,E);n(12,y=[...y,U])}catch{}},h=p=>{const[T,E]=c,U=p.detail.index;l.includes(U)||(T===void 0||E.length===0?n(13,c=[U,ze(r[U])]):T===U?n(13,c=[U,E.slice(1)]):T!==U&&(k(T,U,E),n(13,c=[void 0,[]])))},S=p=>T=>{T.preventDefault();const{sourceStack:E,cards:U}=Un(T);E!==p&&k(E,p,U)},_=p=>T=>{T.preventDefault();try{n(13,c=[void 0,[]]);const E=In(y[y.length-1],p);n(12,y=[...y,E])}catch{}};qt(()=>{ke.update(p=>({...p,undo:O}))}),Vt(()=>{ke.update(p=>({...p,undo:void 0}))});function b(){n(0,d=window.innerWidth),n(1,m=window.innerHeight)}return e.$$.update=()=>{if(e.$$.dirty&3){const p=d<800||m<500?"small":"bridge";rn(T=>({size:T.size==="default"?p:T.size,fourColor:T.colors==="four-color"}))}e.$$.dirty&4096&&n(3,r=y[y.length-1]),e.$$.dirty&8&&n(7,l=Hn(r)),e.$$.dirty&8192&&n(6,i=c[0]),e.$$.dirty&8192&&n(5,u=c[1]),e.$$.dirty&65536&&n(2,a=g.size),e.$$.dirty&5&&n(15,o=d*.95/qn(a)),e.$$.dirty&6&&n(14,s=m*.95/Vn(a)),e.$$.dirty&49152&&n(4,f=`font-size: ${Math.min(o,s)}px`)},[d,m,a,r,f,u,i,l,v,h,S,_,y,c,s,o,g,b]}class Bn extends B{constructor(t){super(),W(this,t,Wn,Jn,H,{})}}function Gn(e){let t;return{c(){t=P("span"),t.textContent=`at ${e[0]} ${e[1]}`},m(n,r){q(n,t,r)},p:j,d(n){n&&K(t)}}}function Qn(e){let t,n,r,l=(e[1]||e[0])&&Gn(e);return{c(){t=P("footer"),n=P("a"),n.textContent="kangasta / pileon",r=V(),l&&l.c(),w(n,"href","https://github.com/kangasta/pileon.git"),w(n,"target","_blank"),w(t,"class","svelte-16t3ryr")},m(i,u){q(i,t,u),A(t,n),A(t,r),l&&l.m(t,null)},p(i,[u]){(i[1]||i[0])&&l.p(i,u)},i:j,o:j,d(i){i&&K(t),l&&l.d()}}}function Xn(e){const t={}.VITE_TAG??"",n="96e882bef363c7173049a3ca0cca037f64e6c467".slice(0,8);return[t,n]}class Yn extends B{constructor(t){super(),W(this,t,Xn,Qn,H,{})}}const Zn=()=>(Math.random()+1).toString(36).substring(5);function $n(e){let t,n,r,l,i,u,a,o,s,f,g;return{c(){t=P("div"),n=P("button"),r=Se("svg"),l=Se("path"),a=V(),o=P("div"),s=Y(e[1]),w(l,"fill","none"),w(l,"stroke","currentColor"),w(l,"stroke-linecap","round"),w(l,"stroke-linejoin","round"),w(l,"stroke-width","1"),w(l,"d",i=e[3][e[0]].path),w(r,"viewBox","0 0 16 16 "),w(r,"class",u=Ie(e[3][e[0]].class)+" svelte-173olzb"),w(n,"aria-labelledby",e[4]),w(n,"class","clickable svelte-173olzb"),F(n,"open",open),w(o,"class","label svelte-173olzb"),w(o,"id",e[4]),w(t,"class","icon-button clickable svelte-173olzb")},m(d,m){q(d,t,m),A(t,n),A(n,r),A(r,l),A(t,a),A(t,o),A(o,s),f||(g=[J(n,"click",function(){Z(e[2])&&e[2].apply(this,arguments)}),J(t,"click",function(){Z(e[2])&&e[2].apply(this,arguments)})],f=!0)},p(d,[m]){e=d,m&1&&i!==(i=e[3][e[0]].path)&&w(l,"d",i),m&1&&u!==(u=Ie(e[3][e[0]].class)+" svelte-173olzb")&&w(r,"class",u),m&0&&F(n,"open",open),m&2&&De(s,e[1])},i:j,o:j,d(d){d&&K(t),f=!1,re(g)}}}function xn(e,t,n){const r={Undo:{path:"M 6 2 L 2 6 L 6 10 M 2 6 L 10 6 A 4 4 0 1 1 10 14 L 8 14"},ChevronDown:{path:"M 4 6 L 8 10 L 12 6",class:"transition-transform"},ChevronUp:{path:"M 4 6 L 8 10 L 12 6",class:"transition-transform mirror-y"}};let{icon:l}=t,{label:i}=t,{onClick:u}=t;const a=`${Zn()}-label`;return e.$$set=o=>{"icon"in o&&n(0,l=o.icon),"label"in o&&n(1,i=o.label),"onClick"in o&&n(2,u=o.onClick)},[l,i,u,r,a]}class At extends B{constructor(t){super(),W(this,t,xn,$n,H,{icon:0,label:1,onClick:2})}}function er(e){let t,n,r,l,i;return{c(){t=P("button"),n=Y(e[0]),w(t,"aria-pressed",r=e[1]?"true":"false"),t.disabled=e[1],w(t,"class","svelte-jc3xzr"),F(t,"pressed",e[1])},m(u,a){q(u,t,a),A(t,n),l||(i=J(t,"click",function(){Z(e[2])&&e[2].apply(this,arguments)}),l=!0)},p(u,[a]){e=u,a&1&&De(n,e[0]),a&2&&r!==(r=e[1]?"true":"false")&&w(t,"aria-pressed",r),a&2&&(t.disabled=e[1]),a&2&&F(t,"pressed",e[1])},i:j,o:j,d(u){u&&K(t),l=!1,i()}}}function tr(e,t,n){let r,l,i;ne(e,ge,f=>n(4,i=f));let{target:u}=t,{value:a}=t;const{update:o}=ge,s=()=>{};return e.$$set=f=>{"target"in f&&n(3,u=f.target),"value"in f&&n(0,a=f.value)},e.$$.update=()=>{e.$$.dirty&25&&n(1,l=i[u]===a),e.$$.dirty&11&&n(2,r=l?s:()=>o(f=>({...f,[u]:a})))},[a,l,r,u,i]}class ee extends B{constructor(t){super(),W(this,t,tr,er,H,{target:3,value:0})}}function ot(e){let t,n;return t=new At({props:{icon:"Undo",label:"Undo",onClick:e[2].undo}}),{c(){z(t.$$.fragment)},m(r,l){N(t,r,l),n=!0},p(r,l){const i={};l&4&&(i.onClick=r[2].undo),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){D(t.$$.fragment,r),n=!1},d(r){M(t,r)}}}function nr(e){let t,n,r,l,i,u,a,o,s,f,g,d,m,v,y,O,c,k,h,S,_,b,p,T,E,U,X,$,Ke,se,qe,ae,Ve,le,Re,he;o=new ee({props:{target:"game",value:"deck"}}),f=new ee({props:{target:"game",value:"pileon"}}),O=new ee({props:{target:"colors",value:"default"}}),k=new ee({props:{target:"colors",value:"standard"}}),S=new ee({props:{target:"colors",value:"four-color"}}),U=new ee({props:{target:"size",value:"default"}}),$=new ee({props:{target:"size",value:"bridge"}}),se=new ee({props:{target:"size",value:"poker"}}),ae=new ee({props:{target:"size",value:"small"}}),le=new At({props:{icon:e[0]?"ChevronUp":"ChevronDown",label:e[1],onClick:e[3]}});let R=e[2].undo!==void 0&&ot(e);return{c(){t=P("div"),n=P("div"),r=P("table"),l=P("tr"),i=P("th"),i.textContent="Game:",u=V(),a=P("td"),z(o.$$.fragment),s=Y(" / "),z(f.$$.fragment),g=V(),d=P("tr"),m=P("th"),m.textContent="Colors:",v=V(),y=P("td"),z(O.$$.fragment),c=Y(" / "),z(k.$$.fragment),h=Y(" / "),z(S.$$.fragment),_=V(),b=P("tr"),p=P("th"),p.textContent="Size:",T=V(),E=P("td"),z(U.$$.fragment),X=Y(" / "),z($.$$.fragment),Ke=Y(" / "),z(se.$$.fragment),qe=Y(" / "),z(ae.$$.fragment),Ve=V(),z(le.$$.fragment),Re=V(),R&&R.c(),w(i,"class","svelte-eflwvb"),w(a,"class","svelte-eflwvb"),w(m,"class","svelte-eflwvb"),w(y,"class","svelte-eflwvb"),w(p,"class","svelte-eflwvb"),w(E,"class","svelte-eflwvb"),w(r,"class","svelte-eflwvb"),w(n,"class","content svelte-eflwvb"),F(n,"open",e[0]),w(t,"class","menu svelte-eflwvb")},m(L,ie){q(L,t,ie),A(t,n),A(n,r),A(r,l),A(l,i),A(l,u),A(l,a),N(o,a,null),A(a,s),N(f,a,null),A(r,g),A(r,d),A(d,m),A(d,v),A(d,y),N(O,y,null),A(y,c),N(k,y,null),A(y,h),N(S,y,null),A(r,_),A(r,b),A(b,p),A(b,T),A(b,E),N(U,E,null),A(E,X),N($,E,null),A(E,Ke),N(se,E,null),A(E,qe),N(ae,E,null),A(t,Ve),N(le,t,null),A(t,Re),R&&R.m(t,null),he=!0},p(L,[ie]){(!he||ie&1)&&F(n,"open",L[0]);const Te={};ie&1&&(Te.icon=L[0]?"ChevronUp":"ChevronDown"),ie&2&&(Te.label=L[1]),le.$set(Te),L[2].undo!==void 0?R?(R.p(L,ie),ie&4&&C(R,1)):(R=ot(L),R.c(),C(R,1),R.m(t,null)):R&&(G(),D(R,1,1,()=>{R=null}),Q())},i(L){he||(C(o.$$.fragment,L),C(f.$$.fragment,L),C(O.$$.fragment,L),C(k.$$.fragment,L),C(S.$$.fragment,L),C(U.$$.fragment,L),C($.$$.fragment,L),C(se.$$.fragment,L),C(ae.$$.fragment,L),C(le.$$.fragment,L),C(R),he=!0)},o(L){D(o.$$.fragment,L),D(f.$$.fragment,L),D(O.$$.fragment,L),D(k.$$.fragment,L),D(S.$$.fragment,L),D(U.$$.fragment,L),D($.$$.fragment,L),D(se.$$.fragment,L),D(ae.$$.fragment,L),D(le.$$.fragment,L),D(R),he=!1},d(L){L&&K(t),M(o),M(f),M(O),M(k),M(S),M(U),M($),M(se),M(ae),M(le),R&&R.d()}}}function rr(e,t,n){let r,l;ne(e,ke,a=>n(2,l=a));let i=!1;const u=a=>{n(0,i=!i),a.stopPropagation()};return e.$$.update=()=>{e.$$.dirty&1&&n(1,r=i?"Close menu":"Open menu")},[i,r,l,u]}class lr extends B{constructor(t){super(),W(this,t,rr,nr,H,{})}}function ir(e){let t,n,r,l,i,u,a,o,s;t=new lr({});var f=e[0];function g(d,m){return{}}return f&&(r=Je(f,g())),u=new Yn({}),{c(){z(t.$$.fragment),n=V(),r&&z(r.$$.fragment),l=V(),i=V(),z(u.$$.fragment)},m(d,m){N(t,d,m),q(d,n,m),r&&N(r,d,m),q(d,l,m),q(d,i,m),N(u,d,m),a=!0,o||(s=J(document.body,"keydown",e[1]),o=!0)},p(d,[m]){if(m&1&&f!==(f=d[0])){if(r){G();const v=r;D(v.$$.fragment,1,0,()=>{M(v,1)}),Q()}f?(r=Je(f,g()),z(r.$$.fragment),C(r.$$.fragment,1),N(r,l.parentNode,l)):r=null}},i(d){a||(C(t.$$.fragment,d),r&&C(r.$$.fragment,d),C(u.$$.fragment,d),a=!0)},o(d){D(t.$$.fragment,d),r&&D(r.$$.fragment,d),D(u.$$.fragment,d),a=!1},d(d){d&&(K(n),K(l),K(i)),M(t,d),r&&M(r,d),M(u,d),o=!1,s()}}}function ur(e,t,n){let r,l,i;ne(e,ke,a=>n(3,l=a)),ne(e,ge,a=>n(2,i=a));const u=a=>{a.key==="z"&&(a.ctrlKey||a.metaKey)&&l.undo!==void 0&&l.undo(a)};return e.$$.update=()=>{e.$$.dirty&4&&n(0,r=i.game==="deck"?Fn:Bn)},[r,u,i]}class sr extends B{constructor(t){super(),W(this,t,ur,ir,H,{})}}new sr({target:document.body});

var Pt=Object.defineProperty;var Ut=(e,t,n)=>t in e?Pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Fe=(e,t,n)=>(Ut(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();function I(){}function Nt(e,t){for(const n in t)e[n]=t[n];return e}function ht(e){return e()}function Ie(){return Object.create(null)}function re(e){e.forEach(ht)}function $(e){return typeof e=="function"}function W(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Mt(e){return Object.keys(e).length===0}function mt(e,...t){if(e==null){for(const r of t)r(void 0);return I}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function zt(e){let t;return mt(e,n=>t=n)(),t}function ne(e,t,n){e.$$.on_destroy.push(mt(t,n))}function Kt(e,t,n,r){if(e){const l=pt(e,t,n,r);return e[0](l)}}function pt(e,t,n,r){return e[1]&&r?Nt(n.ctx.slice(),e[1](r(t))):n.ctx}function qt(e,t,n,r){if(e[2]&&r){const l=e[2](r(n));if(t.dirty===void 0)return l;if(typeof l=="object"){const i=[],s=Math.max(t.dirty.length,l.length);for(let o=0;o<s;o+=1)i[o]=t.dirty[o]|l[o];return i}return t.dirty|l}return t.dirty}function jt(e,t,n,r,l,i){if(l){const s=pt(t,n,r,i);e.p(s,l)}}function Vt(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function He(e){return e??""}function O(e,t){e.appendChild(t)}function q(e,t,n){e.insertBefore(t,n||null)}function N(e){e.parentNode&&e.parentNode.removeChild(e)}function ge(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function F(e){return document.createElement(e)}function ke(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Z(e){return document.createTextNode(e)}function V(){return Z(" ")}function H(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function w(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Rt(e){return Array.from(e.childNodes)}function Ae(e,t){t=""+t,e.data!==t&&(e.data=t)}function Je(e,t,n,r){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}let Se;function It(){if(Se===void 0){Se=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Se=!0}}return Se}function Ht(e,t){getComputedStyle(e).position==="static"&&(e.style.position="relative");const r=F("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const l=It();let i;return l?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",i=H(window,"message",s=>{s.source===r.contentWindow&&t()})):(r.src="about:blank",r.onload=()=>{i=H(r.contentWindow,"resize",t),t()}),O(e,r),()=>{(l||i&&r.contentWindow)&&i(),N(r)}}function L(e,t,n){e.classList.toggle(t,!!n)}function Jt(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}function We(e,t){return new e(t)}let _e;function pe(e){_e=e}function be(){if(!_e)throw new Error("Function called outside component initialization");return _e}function Wt(e){be().$$.on_mount.push(e)}function Bt(e){be().$$.on_destroy.push(e)}function Gt(){const e=be();return(t,n,{cancelable:r=!1}={})=>{const l=e.$$.callbacks[t];if(l){const i=Jt(t,n,{cancelable:r});return l.slice().forEach(s=>{s.call(e,i)}),!i.defaultPrevented}return!0}}function Qt(e,t){return be().$$.context.set(e,t),t}function _t(e){return be().$$.context.get(e)}function Be(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(r=>r.call(this,t))}const ce=[],Ge=[];let de=[];const Qe=[],Xt=Promise.resolve();let Pe=!1;function Yt(){Pe||(Pe=!0,Xt.then(vt))}function ve(e){de.push(e)}const Le=new Set;let ae=0;function vt(){if(ae!==0)return;const e=_e;do{try{for(;ae<ce.length;){const t=ce[ae];ae++,pe(t),Zt(t.$$)}}catch(t){throw ce.length=0,ae=0,t}for(pe(null),ce.length=0,ae=0;Ge.length;)Ge.pop()();for(let t=0;t<de.length;t+=1){const n=de[t];Le.has(n)||(Le.add(n),n())}de.length=0}while(ce.length);for(;Qe.length;)Qe.pop()();Pe=!1,Le.clear(),pe(e)}function Zt(e){if(e.fragment!==null){e.update(),re(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ve)}}function $t(e){const t=[],n=[];de.forEach(r=>e.indexOf(r)===-1?t.push(r):n.push(r)),n.forEach(r=>r()),de=t}const we=new Set;let se;function X(){se={r:0,c:[],p:se}}function Y(){se.r||re(se.c),se=se.p}function C(e,t){e&&e.i&&(we.delete(e),e.i(t))}function A(e,t,n,r){if(e&&e.o){if(we.has(e))return;we.add(e),se.c.push(()=>{we.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function Q(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function K(e){e&&e.c()}function M(e,t,n){const{fragment:r,after_update:l}=e.$$;r&&r.m(t,n),ve(()=>{const i=e.$$.on_mount.map(ht).filter($);e.$$.on_destroy?e.$$.on_destroy.push(...i):re(i),e.$$.on_mount=[]}),l.forEach(ve)}function z(e,t){const n=e.$$;n.fragment!==null&&($t(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function xt(e,t){e.$$.dirty[0]===-1&&(ce.push(e),Yt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function B(e,t,n,r,l,i,s,o=[-1]){const f=_e;pe(e);const u=e.$$={fragment:null,ctx:[],props:i,update:I,not_equal:l,bound:Ie(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:Ie(),dirty:o,skip_bound:!1,root:t.target||f.$$.root};s&&s(u.root);let d=!1;if(u.ctx=n?n(e,t.props||{},(h,a,...m)=>{const g=m.length?m[0]:a;return u.ctx&&l(u.ctx[h],u.ctx[h]=g)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](g),d&&xt(e,h)),a}):[],u.update(),d=!0,re(u.before_update),u.fragment=r?r(u.ctx):!1,t.target){if(t.hydrate){const h=Rt(t.target);u.fragment&&u.fragment.l(h),h.forEach(N)}else u.fragment&&u.fragment.c();t.intro&&C(e.$$.fragment),M(e,t.target,t.anchor),vt()}pe(f)}class G{constructor(){Fe(this,"$$");Fe(this,"$$set")}$destroy(){z(this,1),this.$destroy=I}$on(t,n){if(!$(n))return I;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const l=r.indexOf(n);l!==-1&&r.splice(l,1)}}$set(t){this.$$set&&!Mt(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const en="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(en);const fe=[];function Ue(e,t=I){let n;const r=new Set;function l(o){if(W(e,o)&&(e=o,n)){const f=!fe.length;for(const u of r)u[1](),fe.push(u,e);if(f){for(let u=0;u<fe.length;u+=2)fe[u][0](fe[u+1]);fe.length=0}}}function i(o){l(o(e))}function s(o,f=I){const u=[o,f];return r.add(u),r.size===1&&(n=t(l,i)||I),o(e),()=>{r.delete(u),r.size===0&&n&&(n(),n=null)}}return{set:l,update:i,subscribe:s}}const bt="settings",tn={game:"pileon",colors:"default",size:"default"},nn=JSON.parse(localStorage.getItem(bt)),he=Ue(nn??tn);he.subscribe(e=>localStorage.setItem(bt,JSON.stringify(e)));const rn={},Ce=Ue(rn),ln=4.5,sn=5,un=3,Xe=7,on=5,yt=e=>{switch(e){case"bridge":return{height:Xe,width:ln};case"poker":return{height:Xe,width:sn};case"small":return{height:on,width:un}}},Ne="card-appearance",an={size:"bridge",fourColor:!1},fn=({size:e,colors:t})=>({size:e==="default"?"poker":e,fourColor:t==="four-color"}),St=e=>{const t=Ue(an,n=>(he.subscribe(r=>n(e(r))),()=>{}));return Qt(Ne,t),t},Me=()=>_t(Ne),cn=e=>{const t=_t(Ne);if(t){const n=zt(he);t.set(e(n))}},De=(e,t,n={})=>r=>{(Array.isArray(e)?e:[e]).includes(r.code)&&t!==void 0&&(n.preventDefault&&r.preventDefault(),t())};var te={},ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CardStringType=e.CardSuits=void 0;function t(u,d){if(!(u instanceof d))throw new TypeError("Cannot call a class as a function")}function n(u,d){for(var h=0;h<d.length;h++){var a=d[h];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(u,a.key,a)}}function r(u,d,h){return d&&n(u.prototype,d),h&&n(u,h),u}function l(u,d,h){return d in u?Object.defineProperty(u,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):u[d]=h,u}var i;e.CardSuits=i,function(u){u[u.Hearts=0]="Hearts",u[u.Spades=1]="Spades",u[u.Diamonds=2]="Diamonds",u[u.Clubs=3]="Clubs"}(i||(e.CardSuits=i={}));var s;e.CardStringType=s,function(u){u.Short="SHORT",u.Long="LONG",u.ShortEmoji="SHORT_EMOJI",u.ShortSuit="SHORT_SUIT",u.LongSuit="LONG_SUIT",u.EmojiSuit="EMOJI_SUIT",u.ShortValue="SHORT_VALUE",u.LongValue="LONG_VALUE"}(s||(e.CardStringType=s={}));var o=function(){function u(d){t(this,u),l(this,"num",void 0),this.num=d}return r(u,[{key:"toString",value:function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u.StringType.Long;switch(h){case u.StringType.Short:return this.toString(u.StringType.ShortValue)+this.toString(u.StringType.ShortSuit);case u.StringType.ShortEmoji:return this.toString(u.StringType.ShortValue)+this.toString(u.StringType.EmojiSuit);case u.StringType.Long:return this.toString(u.StringType.LongValue)+" of "+this.toString(u.StringType.LongSuit);case u.StringType.ShortSuit:return u.shortSuits[this.suit];case u.StringType.LongSuit:return u.longSuits[this.suit];case u.StringType.EmojiSuit:return u.emojiSuits[this.suit];case u.StringType.ShortValue:return u.shortValues[this.value===13?0:this.value];case u.StringType.LongValue:return u.longValues[this.value===13?0:this.value]}throw new Error("Unsupported output type")}},{key:"suit",get:function(){return u.getSuit(this.num)}},{key:"value",get:function(){return u.getValue(this.num)}}],[{key:"fromJSON",value:function(h){var a=h.num;return new u(a)}},{key:"getSuit",value:function(h){return Math.floor(h/13)%4}},{key:"getValue",value:function(h){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return h%13||a?h%13:13}},{key:"compare",value:function(h,a){return a.value-h.value}}]),u}();l(o,"Suits",i),l(o,"StringType",s),l(o,"emojiSuits",["♥","♠","♦","♣"]),l(o,"shortSuits",["h","s","d","c"]),l(o,"longSuits",["hearts","spades","diamonds","clubs"]),l(o,"shortValues",["A","2","3","4","5","6","7","8","9","T","J","Q","K"]),l(o,"longValues",["ace","two","three","four","five","six","seven","eight","nine","ten","jack","queen","king"]);var f=o;e.default=f})(ye);var wt={},J={};Object.defineProperty(J,"__esModule",{value:!0});J.uniqueFilter=J.shuffle=J.last=J.isSorted=J.getCombinations=J.arraySubtraction=void 0;var dn=function(t,n){return t.filter(function(r){return!n.includes(r)})};J.arraySubtraction=dn;var gn=function e(t,n,r,l,i){if(l.length>=n)i.push(l);else for(var s=r;s<t.length;s++)e(t,n,s+1,l.concat(t[s]),i)},hn=function(t,n){var r=[];return gn(t,n,0,[],r),r};J.getCombinations=hn;var mn=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,l=r?-1:1;try{return t.reduce(function(i,s){if(l*n(i,s)<=0)return s;throw new Error}),!0}catch{return!1}};J.isSorted=mn;var pn=function(t){return t[t.length-1]};J.last=pn;var _n=function(t){for(var n=t.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1)),l=[t[r],t[n]];t[n]=l[0],t[r]=l[1]}return t};J.shuffle=_n;var vn=function(t,n,r){return r.indexOf(t)===n};J.uniqueFilter=vn;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=r(ye),n=J;function r(g){return g&&g.__esModule?g:{default:g}}function l(g){return o(g)||s(g)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}function o(g){if(Array.isArray(g)){for(var v=0,T=new Array(g.length);v<g.length;v++)T[v]=g[v];return T}}function f(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function u(g,v){for(var T=0;T<v.length;T++){var c=v[T];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(g,c.key,c)}}function d(g,v,T){return v&&u(g.prototype,v),T&&u(g,T),g}function h(g,v,T){return v in g?Object.defineProperty(g,v,{value:T,enumerable:!0,configurable:!0,writable:!0}):g[v]=T,g}var a=function(){function g(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;f(this,g),h(this,"cards",void 0),this.cards=l(Array(52*T).keys()).map(function(c){return new t.default(c)}),v&&this.shuffle()}return d(g,[{key:"shuffle",value:function(){(0,n.shuffle)(this.cards)}},{key:"isShuffled",value:function(){return!(0,n.isSorted)(this.cards,function(T,c){return T.num-c.num})}},{key:"pop",value:function(){return this.cards.pop()}},{key:"popN",value:function(T){for(var c=[],k,p=0;p<T&&(k=this.pop());p++)c.push(k);return c}},{key:"cardsRemaining",get:function(){return this.cards.length}}],[{key:"fromJSON",value:function(T){var c=T.cards,k=new g(!1,0);return k.cards=c.map(function(p){return t.default.fromJSON(p)}),k}}]),g}(),m=a;e.default=m})(wt);var kt={},Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.uuid4=void 0;var bn=function(t){var n;do n=Math.random().toString(16).slice(2,t+2);while(n.length<t&&t<=12);return n},yn=function(){var t=[8,4,4,4,12],n=t.map(bn).join("-").split("");return n[14]="4",n[19]=(Math.floor(Math.random()*64)%4+8).toString(16),n.join("")};Oe.uuid4=yn;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HandRank=void 0;var t=l(ye),n=Oe,r=J;function l(c){return c&&c.__esModule?c:{default:c}}function i(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?i=function(p){return typeof p}:i=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},i(c)}function s(c){return u(c)||f(c)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(c){if(Symbol.iterator in Object(c)||Object.prototype.toString.call(c)==="[object Arguments]")return Array.from(c)}function u(c){if(Array.isArray(c)){for(var k=0,p=new Array(c.length);k<c.length;k++)p[k]=c[k];return p}}function d(c,k){if(!(c instanceof k))throw new TypeError("Cannot call a class as a function")}function h(c,k){for(var p=0;p<k.length;p++){var S=k[p];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(c,S.key,S)}}function a(c,k,p){return k&&h(c.prototype,k),p&&h(c,p),c}function m(c,k,p){return k in c?Object.defineProperty(c,k,{value:p,enumerable:!0,configurable:!0,writable:!0}):c[k]=p,c}var g;e.HandRank=g,function(c){c[c.High=0]="High",c[c.Pair=5]="Pair",c[c.TwoPairs=10]="TwoPairs",c[c.ThreeOfAKind=15]="ThreeOfAKind",c[c.Straight=20]="Straight",c[c.Flush=25]="Flush",c[c.FullHouse=30]="FullHouse",c[c.FourOfAKind=35]="FourOfAKind",c[c.StraightFlush=40]="StraightFlush",c[c.FiveOfAKind=45]="FiveOfAKind"}(g||(e.HandRank=g={}));var v=function(){function c(k,p,S){d(this,c),m(this,"uuid",void 0),m(this,"rank",void 0),m(this,"cards",void 0),this.rank=k,this.cards=p,this.uuid=S||(0,n.uuid4)()}return a(c,[{key:"getCardsString",value:function(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.default.StringType.Short;return this.cards.map(function(S){return S.toString(p)}).join(", ")}},{key:"toString",value:function(){var p=this,S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:t.default.StringType.Short,_=t.default.StringType.LongValue,b=function(E){return p.cards[E].toString(_)},y=this.getCardsString(S);switch(this.rank){case c.Rank.FiveOfAKind:return"Five of a kind, ".concat(b(0),"s (").concat(y,")");case c.Rank.StraightFlush:return"Straigth flush, ".concat(b(0)," high (").concat(y,")");case c.Rank.FourOfAKind:return"Four of a kind, ".concat(b(0),"s (").concat(y,")");case c.Rank.FullHouse:return"Full house, ".concat(b(0),"s over ").concat(b(3),"s (").concat(y,")");case c.Rank.Flush:return"Flush, ".concat(b(0)," high (").concat(y,")");case c.Rank.Straight:return"Straigth, ".concat(b(0)," high (").concat(y,")");case c.Rank.ThreeOfAKind:return"Three of a kind, ".concat(b(0),"s (").concat(y,")");case c.Rank.TwoPairs:return"Two pairs, ".concat(b(0),"s and ").concat(b(2),"s (").concat(y,")");case c.Rank.Pair:return"Pair, ".concat(b(0),"s (").concat(y,")");case c.Rank.High:return"".concat(b(0).replace(/^\w/,function(D){return D.toUpperCase()})," high (").concat(y,")")}throw new Error("Unsupported rank value")}}],[{key:"fromJSON",value:function(p){var S=p.rank,_=p.cards,b=p.uuid;return new c(S,_.map(t.default.fromJSON),b)}},{key:"solve",value:function(p){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_,b;return(_=c.isNumOfAKind(5,p))?b=c.Rank.FiveOfAKind:(_=c.isStraightFlush(p,S))?b=c.Rank.StraightFlush:(_=c.isNumOfAKind(4,p))?b=c.Rank.FourOfAKind:(_=c.isFullHouse(p))?b=c.Rank.FullHouse:(_=c.isFlush(p,S))?b=c.Rank.Flush:(_=c.isStraight(p,S))?b=c.Rank.Straight:(_=c.isNumOfAKind(3,p))?b=c.Rank.ThreeOfAKind:(_=c.isTwoPairs(p))?b=c.Rank.TwoPairs:(_=c.isNumOfAKind(2,p))?b=c.Rank.Pair:(_=[],b=c.Rank.High),_=c.fillWithKickers(_,p),new c(b,_)}},{key:"solveHoldEm",value:function(p,S){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(_===0)return c.solve([].concat(s(p),s(S)));for(var b=(0,r.getCombinations)(p,p.length-_),y=(0,r.getCombinations)(S,Math.min(S.length,_)),D=[],E=0;E<b.length;E++)for(var U=0;U<y.length;U++)D.push(c.solve([].concat(s(b[E]),s(y[U]))));return c.max.apply(c,D)}},{key:"compare",value:function(p,S){var _;if(p.cards.length!==S.cards.length)throw new Error("Comparing hands with different number of cards");if((_=S.rank-p.rank)!==0)return _;for(var b=0;b<p.cards.length;b++)if((_=t.default.compare(p.cards[b],S.cards[b]))!==0)return _;return 0}},{key:"winners",value:function(){for(var p=arguments.length,S=new Array(p),_=0;_<p;_++)S[_]=arguments[_];var b=c.max.apply(c,S);return S.filter(function(y){return!c.compare(y,b)})}},{key:"max",value:function(){for(var p=function(D,E){return c.compare(D,E)<0?D:E},S=arguments.length,_=new Array(S),b=0;b<S;b++)_[b]=arguments[b];return _.reduce(function(y,D){return p(y,D)})}},{key:"fillWithKickers",value:function(p,S){var _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:5;return S=(0,r.arraySubtraction)(S,p).sort(t.default.compare),[].concat(s(p),s(S)).slice(0,_)}},{key:"getUniqueValues",value:function(p){return p.map(function(S){return S.value}).filter(r.uniqueFilter).sort(function(S,_){return _-S})}},{key:"isNumOfAKind",value:function(p,S){for(var _=c.getUniqueValues(S),b,y=function(j){if(b=S.filter(function(x){return x.value==_[j]}),b.length>=p)return{v:b}},D=0;D<_.length;D++){var E=y(D);if(i(E)==="object")return E.v}return!1}},{key:"isNumOfAKindCombination",value:function(p,S){for(var _=[],b=0;b<p.length;b++){var y=c.isNumOfAKind(p[b],(0,r.arraySubtraction)(S,_));if(y===!1)return!1;y=y,_.push.apply(_,s(y))}return _}},{key:"isStraightFlush",value:function(p){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_=[],b=function(U){if(_=p.filter(function(x){return x.suit===U}),_.length<S)return"continue";var j=c.isStraight(_,S);if(j)return{v:j}},y=0;y<4;y++){var D=b(y);switch(D){case"continue":continue;default:if(i(D)==="object")return D.v}}return!1}},{key:"isFullHouse",value:function(p){return c.isNumOfAKindCombination([3,2],p)}},{key:"isFlush",value:function(p){for(var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_=function(E){var U=p.filter(function(j){return j.suit==E});if(U.length>=S)return{v:U.sort(t.default.compare).slice(0,S)}},b=0;b<4;b++){var y=_(b);if(i(y)==="object")return y.v}return!1}},{key:"isStraight",value:function(p){var S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,_=c.getUniqueValues(p);if(_.length<S)return!1;_.includes(13)&&_.push(0);for(var b=[_[0]],y=1;y<_.length&&b.length<S;y++)(0,r.last)(b)-_[y]===1?b.push(_[y]):b=[_[y]];return b.length==S?b.map(function(D){return p.find(function(E){return E.value===(D||13)})}):!1}},{key:"isTwoPairs",value:function(p){return c.isNumOfAKindCombination([2,2],p)}}]),c}();m(v,"Rank",g);var T=v;e.default=T})(kt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Card",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(e,"Deck",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"Hand",{enumerable:!0,get:function(){return r.default}});var t=l(ye),n=l(wt),r=l(kt);function l(i){return i&&i.__esModule?i:{default:i}}})(te);function Sn(e){let t,n;return{c(){t=ke("svg"),n=ke("path"),w(n,"d",e[1]),w(n,"fill","CurrentColor"),w(t,"viewBox","0 0 16 20"),w(t,"class","svelte-1jimf84"),L(t,"flip",e[0])},m(r,l){q(r,t,l),O(t,n)},p(r,[l]){l&2&&w(n,"d",r[1]),l&1&&L(t,"flip",r[0])},i:I,o:I,d(r){r&&N(t)}}}function wn(e,t,n){let r,{suit:l=null}=t,{flip:i=!1}=t;const s=o=>{switch(o){case"hearts":return"M 8 2 C 9 0 11 0 12 0 C 13 0 16 1 16 6 C 16 8 15.5 10 14 12 L 8 20 L 2 12 C 0.5 10 0 8 0 6 C 0 1 3 0 4 0 C 5 0 7 0 8 2";case"spades":return"M 8 0 L 13 5 C 16 8 16 10 16 12 C 16 14 14 16 12 16 C 11 16 9 16 8 14 L 12 20 L 4 20 L 8 14 C 7 16 5 16 4 16 C 2 16 0 14 0 12 C 0 10 0 8 3 5 L 8 0";case"diamonds":return"M 8 0 L 16 10 L 8 20 L 0 10 L 8 0";case"clubs":return"M 8 0 C 10 0 12 2 12 4 C 12 6 11 8 8 10 C 9 8 10 7 12 7 C 14 7 16 9 16 12 C 16 14 14 16 12 16 C 11 16 9 16 8 14 L 12 20 L 4 20 L 8 14 C 7 16 5 16 4 16 C 2 16 0 14 0 12 C 0 9 2 7 4 7 C 6 7 7 8 8 10 C 5 8 4 6 4 4 C 4 2 6 0 8 0";default:return null}};return e.$$set=o=>{"suit"in o&&n(2,l=o.suit),"flip"in o&&n(0,i=o.flip)},e.$$.update=()=>{e.$$.dirty&4&&n(1,r=s(l))},[i,r,l]}class Ct extends G{constructor(t){super(),B(this,t,wn,Sn,W,{suit:2,flip:0})}}function Ye(e,t,n){const r=e.slice();return r[5]=t[n],r}function Ze(e,t,n){const r=e.slice();return r[8]=t[n],r}function $e(e){let t,n,r;return n=new Ct({props:{suit:e[0],flip:e[8].toLowerCase()==="d"}}),{c(){t=F("span"),K(n.$$.fragment),w(t,"class","svelte-1sm49dl")},m(l,i){q(l,t,i),M(n,t,null),r=!0},p(l,i){const s={};i&1&&(s.suit=l[0]),i&2&&(s.flip=l[8].toLowerCase()==="d"),n.$set(s)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(t),z(n)}}}function xe(e){let t,n,r,l,i=Q(e[5].split("")),s=[];for(let f=0;f<i.length;f+=1)s[f]=$e(Ze(e,i,f));const o=f=>A(s[f],1,1,()=>{s[f]=null});return{c(){t=F("div");for(let f=0;f<s.length;f+=1)s[f].c();n=V(),w(t,"class",r="row "+e[3](e[5])+" svelte-1sm49dl")},m(f,u){q(f,t,u);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(t,null);O(t,n),l=!0},p(f,u){if(u&7){i=Q(f[5].split(""));let d;for(d=0;d<i.length;d+=1){const h=Ze(f,i,d);s[d]?(s[d].p(h,u),C(s[d],1)):(s[d]=$e(h),s[d].c(),C(s[d],1),s[d].m(t,n))}for(X(),d=i.length;d<s.length;d+=1)o(d);Y()}(!l||u&2&&r!==(r="row "+f[3](f[5])+" svelte-1sm49dl"))&&w(t,"class",r)},i(f){if(!l){for(let u=0;u<i.length;u+=1)C(s[u]);l=!0}},o(f){s=s.filter(Boolean);for(let u=0;u<s.length;u+=1)A(s[u]);l=!1},d(f){f&&N(t),ge(s,f)}}}function kn(e){let t,n,r=Q(e[2](e[1])),l=[];for(let s=0;s<r.length;s+=1)l[s]=xe(Ye(e,r,s));const i=s=>A(l[s],1,1,()=>{l[s]=null});return{c(){t=F("div");for(let s=0;s<l.length;s+=1)l[s].c();w(t,"class","center-pattern svelte-1sm49dl")},m(s,o){q(s,t,o);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(t,null);n=!0},p(s,[o]){if(o&15){r=Q(s[2](s[1]));let f;for(f=0;f<r.length;f+=1){const u=Ye(s,r,f);l[f]?(l[f].p(u,o),C(l[f],1)):(l[f]=xe(u),l[f].c(),C(l[f],1),l[f].m(t,null))}for(X(),f=r.length;f<l.length;f+=1)i(f);Y()}},i(s){if(!n){for(let o=0;o<r.length;o+=1)C(l[o]);n=!0}},o(s){l=l.filter(Boolean);for(let o=0;o<l.length;o+=1)A(l[o]);n=!1},d(s){s&&N(t),ge(l,s)}}}function Cn(e,t,n){let{suit:r}=t,{rank:l}=t;const i={A:["U"],2:["U","D"],3:["U","U","D"],4:["UU","DD"],5:["UU","U","DD"],6:["UU","UU","DD"],7:["UU","u","UU","DD"],8:["UU","UU","DD","DD"],9:["UU","u","UU","DD","DD"],10:["UU","u","UU","DD","d","DD"]},s=f=>i[f]??[],o=f=>f.toUpperCase()===f?"grow":"";return e.$$set=f=>{"suit"in f&&n(0,r=f.suit),"rank"in f&&n(1,l=f.rank)},[r,l,s,o]}class Dn extends G{constructor(t){super(),B(this,t,Cn,kn,W,{suit:0,rank:1})}}function An(e){let t,n;const r=e[1].default,l=Kt(r,e,e[0],null);return{c(){t=F("span"),l&&l.c(),w(t,"class","screen-reader-only svelte-3uotpv")},m(i,s){q(i,t,s),l&&l.m(t,null),n=!0},p(i,[s]){l&&l.p&&(!n||s&1)&&jt(l,r,i,i[0],n?qt(r,i[0],s,null):Vt(i[0]),null)},i(i){n||(C(l,i),n=!0)},o(i){A(l,i),n=!1},d(i){i&&N(t),l&&l.d(i)}}}function On(e,t,n){let{$$slots:r={},$$scope:l}=t;return e.$$set=i=>{"$$scope"in i&&n(0,l=i.$$scope)},[l,r]}class Tn extends G{constructor(t){super(),B(this,t,On,An,W,{})}}function et(e,t,n){const r=e.slice();return r[16]=t[n],r}function tt(e){let t,n;return t=new Tn({props:{$$slots:{default:[En]},$$scope:{ctx:e}}}),{c(){K(t.$$.fragment)},m(r,l){M(t,r,l),n=!0},p(r,l){const i={};l&524320&&(i.$$scope={dirty:l,ctx:r}),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){z(t,r)}}}function En(e){let t;return{c(){t=Z(e[5])},m(n,r){q(n,t,r)},p(n,r){r&32&&Ae(t,n[5])},d(n){n&&N(t)}}}function nt(e){let t,n;return t=new Dn({props:{suit:e[7],rank:e[8]}}),{c(){K(t.$$.fragment)},m(r,l){M(t,r,l),n=!0},p(r,l){const i={};l&128&&(i.suit=r[7]),l&256&&(i.rank=r[8]),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){z(t,r)}}}function rt(e){let t,n,r,l,i,s,o,f,u,d,h;o=new Ct({props:{suit:e[7]}});let a=!e[10]&&nt(e);return{c(){t=F("div"),n=F("div"),r=Z(e[8]),i=V(),s=F("div"),K(o.$$.fragment),f=V(),u=F("div"),a&&a.c(),d=V(),w(n,"class",l="rank rank-"+e[8]+" svelte-t2vtqs"),w(s,"class","suit svelte-t2vtqs"),w(t,"aria-hidden","true"),w(t,"class",e[16]+" label svelte-t2vtqs"),w(u,"class","center svelte-t2vtqs"),L(u,"face",e[6])},m(m,g){q(m,t,g),O(t,n),O(n,r),O(t,i),O(t,s),M(o,s,null),q(m,f,g),q(m,u,g),a&&a.m(u,null),O(u,d),h=!0},p(m,g){(!h||g&256)&&Ae(r,m[8]),(!h||g&256&&l!==(l="rank rank-"+m[8]+" svelte-t2vtqs"))&&w(n,"class",l);const v={};g&128&&(v.suit=m[7]),o.$set(v),m[10]?a&&(X(),A(a,1,1,()=>{a=null}),Y()):a?(a.p(m,g),g&1024&&C(a,1)):(a=nt(m),a.c(),C(a,1),a.m(u,d)),(!h||g&64)&&L(u,"face",m[6])},i(m){h||(C(o.$$.fragment,m),C(a),h=!0)},o(m){A(o.$$.fragment,m),A(a),h=!1},d(m){m&&(N(t),N(f),N(u)),z(o),a&&a.d()}}}function Fn(e){let t,n,r,l,i=e[3]&&tt(e),s=Q(e[13]),o=[];for(let u=0;u<s.length;u+=1)o[u]=rt(et(e,s,u));const f=u=>A(o[u],1,1,()=>{o[u]=null});return{c(){t=F("div"),i&&i.c(),n=V();for(let u=0;u<o.length;u+=1)o[u].c();w(t,"class",r="card "+e[7]+" stack-"+e[2]+" svelte-t2vtqs"),L(t,"bridge",e[11]),L(t,"small",e[10]),L(t,"fourColor",e[9]),L(t,"empty",e[0]),L(t,"hidden",e[4]),L(t,"shadow",e[1]),L(t,"visible",e[3])},m(u,d){q(u,t,d),i&&i.m(t,null),O(t,n);for(let h=0;h<o.length;h+=1)o[h]&&o[h].m(t,null);l=!0},p(u,[d]){if(u[3]?i?(i.p(u,d),d&8&&C(i,1)):(i=tt(u),i.c(),C(i,1),i.m(t,n)):i&&(X(),A(i,1,1,()=>{i=null}),Y()),d&9664){s=Q(u[13]);let h;for(h=0;h<s.length;h+=1){const a=et(u,s,h);o[h]?(o[h].p(a,d),C(o[h],1)):(o[h]=rt(a),o[h].c(),C(o[h],1),o[h].m(t,null))}for(X(),h=s.length;h<o.length;h+=1)f(h);Y()}(!l||d&132&&r!==(r="card "+u[7]+" stack-"+u[2]+" svelte-t2vtqs"))&&w(t,"class",r),(!l||d&2180)&&L(t,"bridge",u[11]),(!l||d&1156)&&L(t,"small",u[10]),(!l||d&644)&&L(t,"fourColor",u[9]),(!l||d&133)&&L(t,"empty",u[0]),(!l||d&148)&&L(t,"hidden",u[4]),(!l||d&134)&&L(t,"shadow",u[1]),(!l||d&140)&&L(t,"visible",u[3])},i(u){if(!l){C(i);for(let d=0;d<s.length;d+=1)C(o[d]);l=!0}},o(u){A(i),o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)A(o[d]);l=!1},d(u){u&&N(t),i&&i.d(),ge(o,u)}}}function Ln(e,t,n){let r,l,i,s,o,f,u,d,h,a;const m=Me();ne(e,m,p=>n(15,a=p));let{card:g=null}=t,{empty:v=!1}=t,{shadow:T=!1}=t,{stack:c=void 0}=t;const k=["top","bottom"];return e.$$set=p=>{"card"in p&&n(14,g=p.card),"empty"in p&&n(0,v=p.empty),"shadow"in p&&n(1,T=p.shadow),"stack"in p&&n(2,c=p.stack)},e.$$.update=()=>{e.$$.dirty&32768&&n(11,r=a.size==="bridge"),e.$$.dirty&32768&&n(10,l=a.size==="small"),e.$$.dirty&32768&&n(9,i=a.fourColor),e.$$.dirty&16386&&n(4,s=g===null&&!T),e.$$.dirty&19&&n(3,o=!(v||s||T)),e.$$.dirty&16392&&n(8,f=o&&g.toString(te.Card.StringType.ShortValue).replace("T","10")),e.$$.dirty&16392&&n(7,u=o&&g.toString(te.Card.StringType.LongSuit)),e.$$.dirty&16392&&n(6,d=o&&g.num%13>9),e.$$.dirty&16392&&n(5,h=o&&g.toString(te.Card.StringType.Long))},[v,T,c,o,s,h,d,u,f,i,l,r,m,k,g,a]}class Te extends G{constructor(t){super(),B(this,t,Ln,Fn,W,{card:14,empty:0,shadow:1,stack:2})}}function lt(e,t,n){const r=e.slice();return r[18]=t[n].card,r[19]=t[n].shadow,r[20]=t[n].transform,r}function it(e){let t,n;return t=new Te({props:{card:e[0],empty:e[0]===void 0}}),{c(){K(t.$$.fragment)},m(r,l){M(t,r,l),n=!0},p(r,l){const i={};l&1&&(i.card=r[0]),l&1&&(i.empty=r[0]===void 0),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){z(t,r)}}}function st(e){let t,n,r,l;return n=new Te({props:{card:e[18],shadow:e[19]}}),{c(){t=F("div"),K(n.$$.fragment),r=V(),w(t,"class","shadow-container svelte-1ns87h6"),Je(t,"transform",e[20])},m(i,s){q(i,t,s),M(n,t,null),O(t,r),l=!0},p(i,s){const o={};s&16&&(o.card=i[18]),s&16&&(o.shadow=i[19]),n.$set(o),(!l||s&16)&&Je(t,"transform",i[20])},i(i){l||(C(n.$$.fragment,i),l=!0)},o(i){A(n.$$.fragment,i),l=!1},d(i){i&&N(t),z(n)}}}function Pn(e){let t,n,r,l,i,s,o=!e[2]&&it(e),f=Q(e[4]),u=[];for(let h=0;h<f.length;h+=1)u[h]=st(lt(e,f,h));const d=h=>A(u[h],1,1,()=>{u[h]=null});return{c(){t=F("div"),n=F("div"),o&&o.c(),r=V();for(let h=0;h<u.length;h+=1)u[h].c();w(n,"aria-atomic","true"),w(n,"aria-live","polite"),w(t,"aria-label",e[3]),w(t,"class","deck svelte-1ns87h6"),w(t,"role","button"),w(t,"tabindex","0"),L(t,"bridge",e[6]),L(t,"small",e[5]),L(t,"shuffling",e[2])},m(h,a){q(h,t,a),O(t,n),o&&o.m(n,null),O(n,r);for(let m=0;m<u.length;m+=1)u[m]&&u[m].m(n,null);l=!0,i||(s=[H(t,"keydown",function(){$(De(["Space","Enter"],e[1],{preventDefault:!0}))&&De(["Space","Enter"],e[1],{preventDefault:!0}).apply(this,arguments)}),H(t,"click",function(){$(e[1])&&e[1].apply(this,arguments)})],i=!0)},p(h,[a]){if(e=h,e[2]?o&&(X(),A(o,1,1,()=>{o=null}),Y()):o?(o.p(e,a),a&4&&C(o,1)):(o=it(e),o.c(),C(o,1),o.m(n,r)),a&16){f=Q(e[4]);let m;for(m=0;m<f.length;m+=1){const g=lt(e,f,m);u[m]?(u[m].p(g,a),C(u[m],1)):(u[m]=st(g),u[m].c(),C(u[m],1),u[m].m(n,null))}for(X(),m=f.length;m<u.length;m+=1)d(m);Y()}(!l||a&8)&&w(t,"aria-label",e[3]),(!l||a&64)&&L(t,"bridge",e[6]),(!l||a&32)&&L(t,"small",e[5]),(!l||a&4)&&L(t,"shuffling",e[2])},i(h){if(!l){C(o);for(let a=0;a<f.length;a+=1)C(u[a]);l=!0}},o(h){A(o),u=u.filter(Boolean);for(let a=0;a<u.length;a+=1)A(u[a]);l=!1},d(h){h&&N(t),o&&o.d(),ge(u,h),i=!1,re(s)}}}function Un(e,t,n,r){const l=e/r*t,i=.5*l/(n*52),s=1*l/(n*52);return`translate(${i}em , ${s}em)`}function Nn(e,t,n){let r,l,i,s,o,f;const u=Me();ne(e,u,_=>n(15,f=_));let{numCards:d=52}=t,{numDecks:h=1}=t,{topCard:a=null}=t,{numShadows:m=10}=t,{shuffleAnimationSteps:g=4}=t,{shuffleAnimationMaxDistanceEm:v=.8}=t,{shuffleAnimationMaxRotateDeg:T=7}=t,{onClick:c=()=>{}}=t,k=0;function p(_,b){const y=j=>[1,b+2].includes(_)?0:(Math.random()*2-1)*j,D=y(v),E=y(v),U=y(T);return`translate(${D}em, ${E}em) rotate(${U}deg)`}function S(){k>0&&setTimeout(()=>{n(14,k-=1),S()},250)}return e.$$set=_=>{"numCards"in _&&n(8,d=_.numCards),"numDecks"in _&&n(9,h=_.numDecks),"topCard"in _&&n(0,a=_.topCard),"numShadows"in _&&n(10,m=_.numShadows),"shuffleAnimationSteps"in _&&n(11,g=_.shuffleAnimationSteps),"shuffleAnimationMaxDistanceEm"in _&&n(12,v=_.shuffleAnimationMaxDistanceEm),"shuffleAnimationMaxRotateDeg"in _&&n(13,T=_.shuffleAnimationMaxRotateDeg),"onClick"in _&&n(1,c=_.onClick)},e.$$.update=()=>{e.$$.dirty&32768&&n(6,r=(f==null?void 0:f.size)==="bridge"),e.$$.dirty&32768&&n(5,l=(f==null?void 0:f.size)==="small"),e.$$.dirty&2817&&a===null&&d===52*h&&g>0&&(n(14,k=g+2),S()),e.$$.dirty&16384&&n(2,s=k>0),e.$$.dirty&20229&&n(4,i=a===void 0?[]:s?[...Array(m)].map((_,b)=>({card:null,shadow:!1,transform:p(k,g)})):[...Array(m)].map((_,b)=>({card:void 0,shadow:!0,transform:Un(b,d,h,m)}))),e.$$.dirty&1&&n(3,o=a===void 0?"Shuffle the deck":"Draw a card")},[a,c,s,o,i,l,r,u,d,h,m,g,v,T,k,f]}class Mn extends G{constructor(t){super(),B(this,t,Nn,Pn,W,{numCards:8,numDecks:9,topCard:0,numShadows:10,shuffleAnimationSteps:11,shuffleAnimationMaxDistanceEm:12,shuffleAnimationMaxRotateDeg:13,onClick:1})}}function zn(e){let t,n,r;return n=new Mn({props:{onClick:e[2],topCard:e[1],numCards:e[0]}}),{c(){t=F("main"),K(n.$$.fragment),w(t,"class","svelte-1tag1lj")},m(l,i){q(l,t,i),M(n,t,null),r=!0},p(l,[i]){const s={};i&2&&(s.topCard=l[1]),i&1&&(s.numCards=l[0]),n.$set(s)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(t),z(n)}}}function Kn(e,t,n){St(fn);let r=new te.Deck,l=r.cardsRemaining,i=null;function s(){i!==void 0?n(1,i=r.pop()):(r=new te.Deck,n(1,i=null)),n(0,l=r.cardsRemaining)}return[l,i,s]}class qn extends G{constructor(t){super(),B(this,t,Kn,zn,W,{})}}const Dt=(e,t)=>yt(t).width+(e-1)*1.125,jn=(e,t,n)=>{const r={sourceStack:t,cards:n};e.dataTransfer.setData("application/json",JSON.stringify(r)),e.dataTransfer.effectAllowed="move"},Vn=e=>{const{sourceStack:t,cards:n}=JSON.parse(e.dataTransfer.getData("application/json"));return{sourceStack:t,cards:n.map(te.Card.fromJSON)}};function Rn(e){let t,n;return t=new Te({props:{card:e[10]?null:e[0][0],stack:"left"}}),{c(){K(t.$$.fragment)},m(r,l){M(t,r,l),n=!0},p(r,l){const i={};l&1025&&(i.card=r[10]?null:r[0][0]),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){z(t,r)}}}function In(e){let t,n;return t=new Te({props:{empty:!0}}),{c(){K(t.$$.fragment)},m(r,l){M(t,r,l),n=!0},p:I,i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){z(t,r)}}}function ut(e){let t,n,r;return n=new At({props:{cards:e[0].slice(1),capacity:e[1]-1,nested:!0,closed:e[2],index:e[3],isDraggableFn:e[4],selectedCardsN:e[5]}}),{c(){t=F("div"),K(n.$$.fragment),w(t,"class","nested svelte-o50ay1")},m(l,i){q(l,t,i),M(n,t,null),r=!0},p(l,i){const s={};i&1&&(s.cards=l[0].slice(1)),i&2&&(s.capacity=l[1]-1),i&4&&(s.closed=l[2]),i&8&&(s.index=l[3]),i&16&&(s.isDraggableFn=l[4]),i&32&&(s.selectedCardsN=l[5]),n.$set(s)},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(t),z(n)}}}function Hn(e){let t,n,r,l,i,s,o,f;const u=[In,Rn],d=[];function h(m,g){return m[0].length===0?0:1}n=h(e),r=d[n]=u[n](e);let a=e[0].length>1&&ut(e);return{c(){t=F("div"),r.c(),l=V(),a&&a.c(),w(t,"class","stack svelte-o50ay1"),w(t,"style",e[13]),w(t,"draggable",e[12]),w(t,"tabindex",i=e[6]?void 0:0),L(t,"selected",e[11])},m(m,g){q(m,t,g),d[n].m(t,null),O(t,l),a&&a.m(t,null),s=!0,o||(f=[H(t,"dblclick",e[17]),H(t,"dragstart",function(){$(e[9])&&e[9].apply(this,arguments)}),H(t,"dragover",function(){$(e[8])&&e[8].apply(this,arguments)}),H(t,"drop",e[18]),H(t,"click",function(){$(e[7])&&e[7].apply(this,arguments)}),H(t,"keydown",function(){$(De(["Enter","Space"],e[7],{preventDefault:!0}))&&De(["Enter","Space"],e[7],{preventDefault:!0}).apply(this,arguments)})],o=!0)},p(m,[g]){e=m;let v=n;n=h(e),n===v?d[n].p(e,g):(X(),A(d[v],1,1,()=>{d[v]=null}),Y(),r=d[n],r?r.p(e,g):(r=d[n]=u[n](e),r.c()),C(r,1),r.m(t,l)),e[0].length>1?a?(a.p(e,g),g&1&&C(a,1)):(a=ut(e),a.c(),C(a,1),a.m(t,null)):a&&(X(),A(a,1,1,()=>{a=null}),Y()),(!s||g&8192)&&w(t,"style",e[13]),(!s||g&4096)&&w(t,"draggable",e[12]),(!s||g&64&&i!==(i=e[6]?void 0:0))&&w(t,"tabindex",i),(!s||g&2048)&&L(t,"selected",e[11])},i(m){s||(C(r),C(a),s=!0)},o(m){A(r),A(a),s=!1},d(m){m&&N(t),d[n].d(),a&&a.d(),o=!1,re(f)}}}function Jn(e,t,n){let r,l,i,s,o,f,u,d,h;const a=Me();ne(e,a,y=>n(16,h=y));let{cards:m=[]}=t,{capacity:g=4}=t,{closed:v=!1}=t,{index:T=0}=t,{isDraggableFn:c=()=>!1}=t,{selectedCardsN:k=0}=t,{nested:p=!1}=t;const S=Gt();function _(y){Be.call(this,e,y)}function b(y){Be.call(this,e,y)}return e.$$set=y=>{"cards"in y&&n(0,m=y.cards),"capacity"in y&&n(1,g=y.capacity),"closed"in y&&n(2,v=y.closed),"index"in y&&n(3,T=y.index),"isDraggableFn"in y&&n(4,c=y.isDraggableFn),"selectedCardsN"in y&&n(5,k=y.selectedCardsN),"nested"in y&&n(6,p=y.nested)},e.$$.update=()=>{e.$$.dirty&65536&&n(15,r=h.size),e.$$.dirty&32770&&n(13,l=`width: ${Dt(g,r)}em`),e.$$.dirty&21&&n(12,i=!v&&c(m)),e.$$.dirty&33&&n(11,s=k>0&&k===m.length),e.$$.dirty&5&&n(10,o=v&&m.length===1),e.$$.dirty&9&&n(9,f=y=>{y.stopPropagation(),jn(y,T,m)}),e.$$.dirty&72&&n(7,d=()=>{p||S("select",{index:T})})},n(8,u=y=>{y.preventDefault()}),[m,g,v,T,c,k,p,d,u,f,o,s,i,l,a,r,h,_,b]}class At extends G{constructor(t){super(),B(this,t,Jn,Hn,W,{cards:0,capacity:1,closed:2,index:3,isDraggableFn:4,selectedCardsN:5,nested:6})}}const Ot=(e,t)=>{const n=e/t;return n<3/4?[3,5]:n<4/3?[4,4]:[5,3]},ot=(e,t)=>{const[n,r]=Ot(e,t);return{length:n*r-15}},Wn=(e,t,n,r)=>{const[l,i]=Ot(t,r),s=Dt(4,e)*l+(e!=="small"?.666:.333)*10,o=t*.95/s,f=yt(e).height*i+(e!=="small"?.5:.25)*6,d=(n>600?n:r)*.95/f;return Math.min(o,d)},Bn=()=>{const e=new te.Deck;return[...Array(13)].map(()=>e.popN(4)).concat([[],[]])},ze=e=>{const[t,...n]=e;return n.every(r=>r.value===t.value)},Gn=e=>e.length===0?!1:e.length===1?!0:ze(e),Tt=(e,t)=>e.length+t.length>4?!1:t.length===0||t[t.length-1].value===e[0].value,Et=(e,t,n,r)=>{const l=e.map(i=>[...i]);if(!Tt(r,l[n]))throw new Error(`Can not move cards ${r.map(i=>i.toString(ye.CardStringType.ShortEmoji))} from pile ${t} to pile ${n}`);return l[t]=l[t].slice(0,l[t].length-r.length),l[n]=[...l[n],...r],l},Ke=e=>e.length===1||ze(e)?e:Ke(e.slice(1)),Qn=(e,t)=>{if(e[t].length===0)throw new Error("Cannot move cards from an empty pile.");if(Ft(e[t]))throw new Error("Cannot move cards from a completed pile.");const n=Ke(e[t]),r=e.reduce((s,o,f)=>f!==t&&Tt(n,o)?[...s,f]:s,[]);if(r.length===0)throw new Error(`Cannot move cards from pile ${t} to any other pile`);const l=r.filter(s=>e[s].length>0),i=l.length>0?l[0]:r[0];return Et(e,t,i,n)},Ft=e=>e.length===4&&ze(e),Xn=e=>e.reduce((t,n,r)=>Ft(n)?[...t,r]:t,[]);function at(e,t,n){const r=e.slice();return r[21]=t[n],r}function ft(e,t,n){const r=e.slice();return r[24]=t[n],r[26]=n,r}function ct(e){let t,n,r;return n=new At({props:{cards:e[24],closed:e[8].includes(e[26]),selectedCardsN:e[7]===e[26]?e[6].length:0,index:e[26],isDraggableFn:Gn}}),n.$on("drop",e[11](e[26])),n.$on("dblclick",e[12](e[26])),n.$on("select",e[10]),{c(){t=F("div"),K(n.$$.fragment),w(t,"class","pile svelte-1qdb0j4"),L(t,"small",e[3]==="small")},m(l,i){q(l,t,i),M(n,t,null),r=!0},p(l,i){const s={};i&16&&(s.cards=l[24]),i&256&&(s.closed=l[8].includes(l[26])),i&192&&(s.selectedCardsN=l[7]===l[26]?l[6].length:0),n.$set(s),(!r||i&8)&&L(t,"small",l[3]==="small")},i(l){r||(C(n.$$.fragment,l),r=!0)},o(l){A(n.$$.fragment,l),r=!1},d(l){l&&N(t),z(n)}}}function dt(e){let t;return{c(){t=F("div"),w(t,"class","pile svelte-1qdb0j4")},m(n,r){q(n,t,r)},p:I,d(n){n&&N(t)}}}function Yn(e){let t,n,r,l,i,s;ve(e[17]);let o=Q(e[4]),f=[];for(let a=0;a<o.length;a+=1)f[a]=ct(ft(e,o,a));const u=a=>A(f[a],1,1,()=>{f[a]=null});let d=Q(ot(e[0],e[2])),h=[];for(let a=0;a<d.length;a+=1)h[a]=dt(at(e,d,a));return{c(){t=F("main");for(let a=0;a<f.length;a+=1)f[a].c();n=V();for(let a=0;a<h.length;a+=1)h[a].c();w(t,"class","pileon svelte-1qdb0j4"),w(t,"style",e[5]),ve(()=>e[18].call(t))},m(a,m){q(a,t,m);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(t,null);O(t,n);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(t,null);r=Ht(t,e[18].bind(t)),l=!0,i||(s=H(window,"resize",e[17]),i=!0)},p(a,[m]){if(m&7640){o=Q(a[4]);let g;for(g=0;g<o.length;g+=1){const v=ft(a,o,g);f[g]?(f[g].p(v,m),C(f[g],1)):(f[g]=ct(v),f[g].c(),C(f[g],1),f[g].m(t,n))}for(X(),g=o.length;g<f.length;g+=1)u(g);Y()}if(m&5){d=Q(ot(a[0],a[2]));let g;for(g=0;g<d.length;g+=1){const v=at(a,d,g);h[g]?h[g].p(v,m):(h[g]=dt(),h[g].c(),h[g].m(t,null))}for(;g<h.length;g+=1)h[g].d(1);h.length=d.length}(!l||m&32)&&w(t,"style",a[5])},i(a){if(!l){for(let m=0;m<o.length;m+=1)C(f[m]);l=!0}},o(a){f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)A(f[m]);l=!1},d(a){a&&N(t),ge(f,a),ge(h,a),r(),i=!1,s()}}}function Zn(e,t,n){let r,l,i,s,o,f,u,d,h,a,m,g=St(D=>({size:D.size==="default"?"bridge":D.size,fourColor:D.colors==="four-color"}));ne(e,g,D=>n(16,d=D));let v=[Bn()];const T=D=>{D.stopPropagation(),v.length>1&&n(13,v=v.slice(0,v.length-1))};let c=[void 0,[]];const k=(D,E,U)=>{try{n(14,c=[void 0,[]]);const j=Et(v[v.length-1],D,E,U);n(13,v=[...v,j])}catch{}},p=D=>{const[E,U]=c,j=D.detail.index;l.includes(j)||(E===void 0||U.length===0?n(14,c=[j,Ke(r[j])]):E===j?n(14,c=[j,U.slice(1)]):E!==j&&(k(E,j,U),n(14,c=[void 0,[]])))},S=D=>E=>{E.preventDefault();const{sourceStack:U,cards:j}=Vn(E);U!==D&&k(U,D,j)},_=D=>E=>{E.preventDefault();try{n(14,c=[void 0,[]]);const U=Qn(v[v.length-1],D);n(13,v=[...v,U])}catch{}};Wt(()=>{Ce.update(D=>({...D,undo:T}))}),Bt(()=>{Ce.update(D=>({...D,undo:void 0}))});function b(){n(2,m=window.innerHeight)}function y(){a=this.clientHeight,h=this.clientWidth,n(1,a),n(0,h)}return e.$$.update=()=>{if(e.$$.dirty&5){const D=h<800||m<500?"small":"bridge";cn(E=>({size:E.size==="default"?D:E.size,fourColor:E.colors==="four-color"}))}e.$$.dirty&8192&&n(4,r=v[v.length-1]),e.$$.dirty&16&&n(8,l=Xn(r)),e.$$.dirty&16384&&n(7,i=c[0]),e.$$.dirty&16384&&n(6,s=c[1]),e.$$.dirty&65536&&n(3,o=d.size),e.$$.dirty&15&&n(15,f=Wn(o,h,a,m)),e.$$.dirty&32768&&n(5,u=`font-size: ${f}px`)},[h,a,m,o,r,u,s,i,l,g,p,S,_,v,c,f,d,b,y]}class $n extends G{constructor(t){super(),B(this,t,Zn,Yn,W,{})}}function xn(e){let t;return{c(){t=F("span"),t.textContent=`at ${e[0]} ${e[1]}`},m(n,r){q(n,t,r)},p:I,d(n){n&&N(t)}}}function er(e){let t,n,r,l=(e[1]||e[0])&&xn(e);return{c(){t=F("footer"),n=F("a"),n.textContent="kangasta / pileon",r=V(),l&&l.c(),w(n,"href","https://github.com/kangasta/pileon.git"),w(n,"target","_blank"),w(t,"class","svelte-16t3ryr")},m(i,s){q(i,t,s),O(t,n),O(t,r),l&&l.m(t,null)},p(i,[s]){(i[1]||i[0])&&l.p(i,s)},i:I,o:I,d(i){i&&N(t),l&&l.d()}}}function tr(e){const t={}.VITE_TAG??"",n="a5e5558ef66a7609d163a723737f5c6eb678c671".slice(0,8);return[t,n]}class nr extends G{constructor(t){super(),B(this,t,tr,er,W,{})}}const rr=()=>(Math.random()+1).toString(36).substring(5);function lr(e){let t,n,r,l,i,s,o,f,u,d,h;return{c(){t=F("div"),n=F("button"),r=ke("svg"),l=ke("path"),o=V(),f=F("div"),u=Z(e[1]),w(l,"fill","none"),w(l,"stroke","currentColor"),w(l,"stroke-linecap","round"),w(l,"stroke-linejoin","round"),w(l,"stroke-width","1"),w(l,"d",i=e[3][e[0]].path),w(r,"viewBox","0 0 16 16 "),w(r,"class",s=He(e[3][e[0]].class)+" svelte-173olzb"),w(n,"aria-labelledby",e[4]),w(n,"class","clickable svelte-173olzb"),L(n,"open",open),w(f,"class","label svelte-173olzb"),w(f,"id",e[4]),w(t,"class","icon-button clickable svelte-173olzb")},m(a,m){q(a,t,m),O(t,n),O(n,r),O(r,l),O(t,o),O(t,f),O(f,u),d||(h=[H(n,"click",function(){$(e[2])&&e[2].apply(this,arguments)}),H(t,"click",function(){$(e[2])&&e[2].apply(this,arguments)})],d=!0)},p(a,[m]){e=a,m&1&&i!==(i=e[3][e[0]].path)&&w(l,"d",i),m&1&&s!==(s=He(e[3][e[0]].class)+" svelte-173olzb")&&w(r,"class",s),m&0&&L(n,"open",open),m&2&&Ae(u,e[1])},i:I,o:I,d(a){a&&N(t),d=!1,re(h)}}}function ir(e,t,n){const r={Undo:{path:"M 6 2 L 2 6 L 6 10 M 2 6 L 10 6 A 4 4 0 1 1 10 14 L 8 14"},ChevronDown:{path:"M 4 6 L 8 10 L 12 6",class:"transition-transform"},ChevronUp:{path:"M 4 6 L 8 10 L 12 6",class:"transition-transform mirror-y"}};let{icon:l}=t,{label:i}=t,{onClick:s}=t;const o=`${rr()}-label`;return e.$$set=f=>{"icon"in f&&n(0,l=f.icon),"label"in f&&n(1,i=f.label),"onClick"in f&&n(2,s=f.onClick)},[l,i,s,r,o]}class Lt extends G{constructor(t){super(),B(this,t,ir,lr,W,{icon:0,label:1,onClick:2})}}function sr(e){let t,n,r,l,i;return{c(){t=F("button"),n=Z(e[0]),w(t,"aria-pressed",r=e[1]?"true":"false"),t.disabled=e[1],w(t,"class","svelte-jc3xzr"),L(t,"pressed",e[1])},m(s,o){q(s,t,o),O(t,n),l||(i=H(t,"click",function(){$(e[2])&&e[2].apply(this,arguments)}),l=!0)},p(s,[o]){e=s,o&1&&Ae(n,e[0]),o&2&&r!==(r=e[1]?"true":"false")&&w(t,"aria-pressed",r),o&2&&(t.disabled=e[1]),o&2&&L(t,"pressed",e[1])},i:I,o:I,d(s){s&&N(t),l=!1,i()}}}function ur(e,t,n){let r,l,i;ne(e,he,d=>n(4,i=d));let{target:s}=t,{value:o}=t;const{update:f}=he,u=()=>{};return e.$$set=d=>{"target"in d&&n(3,s=d.target),"value"in d&&n(0,o=d.value)},e.$$.update=()=>{e.$$.dirty&25&&n(1,l=i[s]===o),e.$$.dirty&11&&n(2,r=l?u:()=>f(d=>({...d,[s]:o})))},[o,l,r,s,i]}class ee extends G{constructor(t){super(),B(this,t,ur,sr,W,{target:3,value:0})}}function gt(e){let t,n;return t=new Lt({props:{icon:"Undo",label:"Undo",onClick:e[2].undo}}),{c(){K(t.$$.fragment)},m(r,l){M(t,r,l),n=!0},p(r,l){const i={};l&4&&(i.onClick=r[2].undo),t.$set(i)},i(r){n||(C(t.$$.fragment,r),n=!0)},o(r){A(t.$$.fragment,r),n=!1},d(r){z(t,r)}}}function or(e){let t,n,r,l,i,s,o,f,u,d,h,a,m,g,v,T,c,k,p,S,_,b,y,D,E,U,j,x,qe,ue,je,oe,Ve,le,Re,me;f=new ee({props:{target:"game",value:"deck"}}),d=new ee({props:{target:"game",value:"pileon"}}),T=new ee({props:{target:"colors",value:"default"}}),k=new ee({props:{target:"colors",value:"standard"}}),S=new ee({props:{target:"colors",value:"four-color"}}),U=new ee({props:{target:"size",value:"default"}}),x=new ee({props:{target:"size",value:"bridge"}}),ue=new ee({props:{target:"size",value:"poker"}}),oe=new ee({props:{target:"size",value:"small"}}),le=new Lt({props:{icon:e[0]?"ChevronUp":"ChevronDown",label:e[1],onClick:e[3]}});let R=e[2].undo!==void 0&&gt(e);return{c(){t=F("div"),n=F("div"),r=F("table"),l=F("tr"),i=F("th"),i.textContent="Game:",s=V(),o=F("td"),K(f.$$.fragment),u=Z(" / "),K(d.$$.fragment),h=V(),a=F("tr"),m=F("th"),m.textContent="Colors:",g=V(),v=F("td"),K(T.$$.fragment),c=Z(" / "),K(k.$$.fragment),p=Z(" / "),K(S.$$.fragment),_=V(),b=F("tr"),y=F("th"),y.textContent="Size:",D=V(),E=F("td"),K(U.$$.fragment),j=Z(" / "),K(x.$$.fragment),qe=Z(" / "),K(ue.$$.fragment),je=Z(" / "),K(oe.$$.fragment),Ve=V(),K(le.$$.fragment),Re=V(),R&&R.c(),w(i,"class","svelte-eflwvb"),w(o,"class","svelte-eflwvb"),w(m,"class","svelte-eflwvb"),w(v,"class","svelte-eflwvb"),w(y,"class","svelte-eflwvb"),w(E,"class","svelte-eflwvb"),w(r,"class","svelte-eflwvb"),w(n,"class","content svelte-eflwvb"),L(n,"open",e[0]),w(t,"class","menu svelte-eflwvb")},m(P,ie){q(P,t,ie),O(t,n),O(n,r),O(r,l),O(l,i),O(l,s),O(l,o),M(f,o,null),O(o,u),M(d,o,null),O(r,h),O(r,a),O(a,m),O(a,g),O(a,v),M(T,v,null),O(v,c),M(k,v,null),O(v,p),M(S,v,null),O(r,_),O(r,b),O(b,y),O(b,D),O(b,E),M(U,E,null),O(E,j),M(x,E,null),O(E,qe),M(ue,E,null),O(E,je),M(oe,E,null),O(t,Ve),M(le,t,null),O(t,Re),R&&R.m(t,null),me=!0},p(P,[ie]){(!me||ie&1)&&L(n,"open",P[0]);const Ee={};ie&1&&(Ee.icon=P[0]?"ChevronUp":"ChevronDown"),ie&2&&(Ee.label=P[1]),le.$set(Ee),P[2].undo!==void 0?R?(R.p(P,ie),ie&4&&C(R,1)):(R=gt(P),R.c(),C(R,1),R.m(t,null)):R&&(X(),A(R,1,1,()=>{R=null}),Y())},i(P){me||(C(f.$$.fragment,P),C(d.$$.fragment,P),C(T.$$.fragment,P),C(k.$$.fragment,P),C(S.$$.fragment,P),C(U.$$.fragment,P),C(x.$$.fragment,P),C(ue.$$.fragment,P),C(oe.$$.fragment,P),C(le.$$.fragment,P),C(R),me=!0)},o(P){A(f.$$.fragment,P),A(d.$$.fragment,P),A(T.$$.fragment,P),A(k.$$.fragment,P),A(S.$$.fragment,P),A(U.$$.fragment,P),A(x.$$.fragment,P),A(ue.$$.fragment,P),A(oe.$$.fragment,P),A(le.$$.fragment,P),A(R),me=!1},d(P){P&&N(t),z(f),z(d),z(T),z(k),z(S),z(U),z(x),z(ue),z(oe),z(le),R&&R.d()}}}function ar(e,t,n){let r,l;ne(e,Ce,o=>n(2,l=o));let i=!1;const s=o=>{n(0,i=!i),o.stopPropagation()};return e.$$.update=()=>{e.$$.dirty&1&&n(1,r=i?"Close menu":"Open menu")},[i,r,l,s]}class fr extends G{constructor(t){super(),B(this,t,ar,or,W,{})}}function cr(e){let t,n,r,l,i,s,o,f,u;t=new fr({});var d=e[0];function h(a,m){return{}}return d&&(r=We(d,h())),s=new nr({}),{c(){K(t.$$.fragment),n=V(),r&&K(r.$$.fragment),l=V(),i=V(),K(s.$$.fragment)},m(a,m){M(t,a,m),q(a,n,m),r&&M(r,a,m),q(a,l,m),q(a,i,m),M(s,a,m),o=!0,f||(u=H(document.body,"keydown",e[1]),f=!0)},p(a,[m]){if(m&1&&d!==(d=a[0])){if(r){X();const g=r;A(g.$$.fragment,1,0,()=>{z(g,1)}),Y()}d?(r=We(d,h()),K(r.$$.fragment),C(r.$$.fragment,1),M(r,l.parentNode,l)):r=null}},i(a){o||(C(t.$$.fragment,a),r&&C(r.$$.fragment,a),C(s.$$.fragment,a),o=!0)},o(a){A(t.$$.fragment,a),r&&A(r.$$.fragment,a),A(s.$$.fragment,a),o=!1},d(a){a&&(N(n),N(l),N(i)),z(t,a),r&&z(r,a),z(s,a),f=!1,u()}}}function dr(e,t,n){let r,l,i;ne(e,Ce,o=>n(3,l=o)),ne(e,he,o=>n(2,i=o));const s=o=>{o.key==="z"&&(o.ctrlKey||o.metaKey)&&l.undo!==void 0&&l.undo(o)};return e.$$.update=()=>{e.$$.dirty&4&&n(0,r=i.game==="deck"?qn:$n)},[r,s,i]}class gr extends G{constructor(t){super(),B(this,t,dr,cr,W,{})}}new gr({target:document.body});
